
Public Enum SpecCodesEnum
    S01_0_ServoLinkNCAxis = 90100
    S01_1_BLANK = 90100
    S01_2_BLANK = 90100
    S01_3_BLANK = 90100
    S01_4_ServoLinkSpindle = 90104
    S01_5_SpindleDA = 90105
    S01_6_SpindleIO = 90106
    S01_7_BLANK7 = 90107
    S02_0_4Axis2Saddle = 90200
    S02_1_2Turrets1Saddle = 90201
    S02_2_WAxisOverlap = 90202
    S02_3_CAMLathe = 90203
    S02_4_NewWAxisData = 90204
    S02_5_SubMagazine = 90205
    S02_6_H1Turret = 90206
    S02_7_FlatBed = 90207
    S03_0_MultitaskingMachine = 90300
    S03_1_BTurretMAxis = 90301
    S03_2_WithoutMAxisCAxis = 90302
    S03_3_TMAxisSwitchingControl = 90303
    S03_4_LToolIndex = 90304
    S03_5_CAxisPEC = 90305
    S03_6_MultiMagazine = 90306
    S03_7_SynchronizedReserve = 90307
    S04_0_LTMechanism = 90400
    S04_1_SubSpindle = 90401
    S04_2_Parallel2Spindle = 90402
    S04_3_PickOffMechanism = 90403
    S04_4_VerticalLathe = 90404
    S04_5_LAW_VMechanism = 90405
    S04_6_ACCMechanism = 90406
    S04_7_BTurretSubSpindle = 90407
    S05_0_0_NCTurret = 90500
    S05_1_OTCTurret = 90501
    S05_2_CAMTypeTurret = 90502
    S05_3_MultiInsertTool = 90503
    S05_4_ABsocaleDetectionTA = 90504
    S05_5_TurretBAxisIndexing = 90505
    S05_6_HeavyTooling = 90506
    S05_7_DoubleTooling = 90507
    S06_0_HiGControl = 90600
    S06_1_PFCIIFunction = 90601
    S06_2_BAxisPEC = 90602
    S06_3_XAxisMirrorImageCoordinate = 90603
    S06_4_WorkCoordiate10Sets = 90604
    S06_5_WorkCoordiate50Sets = 90605
    S06_6_ToolCompensation500Sets = 90606
    S06_7_ToolLifeWarning = 90607
    S07_0_ATC = 90700
    S07_1_1CAMATC = 90701
    S07_2_2CAMATC = 90702
    S07_3_ATCExternalHPFunction = 90703
    S07_4_VTMMechanism = 90704
    S07_5_NewMagazinePanel = 90705
    S07_6_MagazinePanelOldSystem = 90706
    S07_7_YAxisTorqueLimit = 90707
    S08_0_SlantYAxis = 90800
    S08_1_YAxisByCT_Z = 90801
    S08_2_AbsocaleDetectionYS = 90802
    S08_3_YAxisBarrier = 90803
    S08_4_HorizontalBarrier = 90804
    S08_5_BAxisControlOne_1000thDegreePitch = 90805
    S08_6_BAxisControl1DegreePitch = 90806
    S08_7_BAxisControl = 90807
    S09_0_STNLCDMono = 90900
    S09_1_E100Spec = 90901
    S09_2_3DAnimation = 90902
    S09_3_ACPExpansion = 90903
    S09_4_AnimationSpec = 90904
    S09_5_S10Spec = 90905
    S09_6_U100U10Spec = 90906
    S09_7_OACMessage = 90907
    S10_0_OneTouchIGF = 91000
    S10_1_IGF = 91001
    S10_2_IGFConvert = 91002
    S10_3_IGFDataTransfer = 91003
    S10_4_ExcelMachining = 91004
    S10_5_CollisionAvoidanceSystem = 91005
    S10_6_ProgrammingHelp = 91006
    S10_7_HelpFunction = 91007
    S11_0_LAP4 = 91100
    S11_1_NoseR2B = 91101
    S11_2_UserTask2 = 91102
    S11_3_AnyAngleChamfering = 91103
    S11_4_ThreadPhasing = 91104
    S11_5_G34G35Hold = 91105
    S11_6_ArcThreading = 91106
    S11_7_CommonVaraible1000Sets = 91107
    S12_0_HomePosition = 91200
    S12_1_SpindleSynchonizedTapping = 91201
    S12_2_ToolRetraction = 91202
    S12_3_HarmonicSpindleSpeedControl_HSSC = 91203
    S12_4_NCTorqueLimit = 91204
    S12_5_VariableSpindleSpeedThreading_VSST = 91205
    S12_6_GMCodeMacro = 91206
    S12_7_YAxisTuringCenterOffsetFunction = 91207
    S13_0_PlanConversion = 91300
    S13_1_ProfileGeneration = 91301
    S13_2_ContourCutting = 91302
    S13_3_BAxisInterpolation = 91303
    S13_4_SynchronizedTapping = 91304
    S13_5_FlatTurning = 91305
    S13_6_HelicalCutting = 91306
    S13_7_SlantCutting = 91307
    S14_0_ProgramSelection = 91400
    S14_1_MGToolPrepCycle = 91401
    S14_2_CommonVariableNameRegistration = 91402
    S14_3_HomePositionB = 91403
    S14_4_DWarmingUp = 91404
    S14_5_MachineLockSpecial = 91405
    S14_6_G00LinearInterpolation = 91406
    S14_7_ABSynchronizatedFeedingFunction = 91407
    S15_0_Buffer160m = 91500
    S15_1_Buffer320m = 91501
    S15_2_Buffer640m = 91502
    S15_3_Buffer1280m = 91503
    S15_4_BLANK4 = 91504
    S15_5_FDD3_5InchEdit = 91505
    S15_6_EditInterlock = 91506
    S15_7_EditInterlockTypeC = 91507
    S16_0_AdvanceOneTouchIGF = 91600
    S16_1_TapeDataInputOutput = 91601
    S16_2_FDDInOut_IBM = 91602
    S16_3_WithoutMSDOS = 91603
    S16_4_TurretSeparateEdit = 91604
    S16_5_DNC_CEthernet = 91605
    S16_6_P200Spec = 91606
    S16_7_FLNet = 91607
    S17_0_DNC_A = 91700
    S17_1_DNC_B = 91701
    S17_2_DNC_C1 = 91702
    S17_3_DNC_C2 = 91703
    S17_4_DNC_C3 = 91704
    S17_5_DNC_DT = 91705
    S17_6_SimpleRemoteDiagnosticFunction = 91706
    S17_7_DNC_RT = 91707
    S18_0_DNC_T1 = 91800
    S18_1_DNC_T2 = 91801
    S18_2_DNC_T3 = 91802
    S18_3_DNC_T4 = 91803
    S18_4_DNC_P1 = 91804
    S18_5_DNC_P2 = 91805
    S18_6_DNC_P3 = 91806
    S18_7_DNC_P4 = 91807
    S19_0_NCWorkCounter = 91900
    S19_1_WorkCounterSpecial = 91901
    S19_2_NCOperationMonitor = 91902
    S19_3_CycleTimeOver = 91903
    S19_8_LoadMonitor = 91904
    S19_5_LoadMonitorW = 91905
    S19_6_MacManNetworkFunction = 91906
    S19_7_MacMan = 91907
    S20_0_1MicronControl = 92000
    S20_1_InchMetricSwitch = 92001
    S20_2_ScriptFunction = 92002
    S20_3_WindowsOperationPermission = 92003
    S20_4_CycleTimeCalculation = 92004
    S20_5_CycleTimeReduction = 92005
    S20_6_CycleTimeReductionNew = 92006
    S20_7_NoLoadDetection = 92007
    S21_0_TurretPositionCompensation = 92100
    S21_1_ToolOffset64Sets = 92101
    S21_2_ToolOffset96Sets = 92102
    S21_3_ToolLifeManagement = 92103
    S21_4_ToolOffset200Sets = 92104
    S21_5_ToolWearCompensation = 92105
    S21_6_ToolOffsetMultiSystem = 92106
    S21_7_ToolOffset800Sets = 92107
    S22_0_PitchErrorCompensation = 92200
    S22_1_InductoSyncPitchCompensation = 92201
    S22_2_AbsoscaleZA = 92202
    S22_3_AbsoscaleXA = 92203
    S22_4_AbsoscaleZB = 92204
    S22_5_AbsoscaleXB = 92205
    S22_6_AbsoscaleCA = 92206
    S22_7_WithoutPitchErrorCompensation = 92207
    S23_0_TouchSetter_0 = 92300
    S23_1_2ndSpindleGauging = 92301
    S23_2_TouchSetterAuto = 92302
    S23_3_TouchSetter_3 = 92303
    S23_4_CAxisZeroOffset = 92304
    S23_5_YAxisGauging = 92305
    S23_6_OpticalSensor = 92306
    S23_7_GaugingDataPrintOut = 92307
    S24_0_PostProcessGauging = 92400
    S24_1_PostProcessGaugingRS232C = 92401
    S24_2_CEJMatic = 92402
    S24_3_SizeCatcher = 92403
    S24_4_PostProcessGaugingBCD = 92404
    S24_5_TouchSetterRLCommon = 92405
    S24_6_BLANK6 = 92406
    S24_7_BLANK7 = 92407
    S25_0_SpindleMaxSpeedIL = 92500
    S25_1_HeadStockInterferenceIL = 92501
    S25_2_PartCatcherIL = 92502
    S25_3_1S_SubSpindlePartsCatcherIL = 92503
    S25_4_ZA_WAxisInterfenceIL = 92504
    S25_5_XB_WAxisInterfenceIL = 92505
    S25_6_BLANK6 = 92506
    S25_7_TailStockSteadyRestIL = 92507
    S26_0_SpindleOrientation = 92600
    S26_1_BLANK1 = 92601
    S26_2_BTurretWithoutMAxisCAxis = 92602
    S26_3_CAxisSynchronizedControl = 92603
    S26_4_MAxisOrientation = 92604
    S26_5_LMultitasking = 92605
    S26_6_RMultitasking = 92606
    S26_7_HobbingFunction = 92607
    S27_0_ProgrammableTailStock = 92700
    S27_1_SimpleTowAlongTailStock = 92701
    S27_2_ProgrammableTailStockB = 92702
    S27_3_NCTailStock_3 = 92703
    S27_4_TailStockClampControl = 92704
    S27_5_NCTailStock_5 = 92705
    S27_6_NCTailStockTorqueControl = 92706
    S27_7_ToolNose12AngleTool = 92707
    S28_0_NCRobot = 92800
    S28_1_NCLoader = 92801
    S28_2_SystemStatusDisplay = 92802
    S28_3_OHLogogChange = 92803
    S28_4_CAxisPitchErrorCompensation_2 = 92804
    S28_5_FConvert = 92805
    S28_6_LostMotionCompensation = 92806
    S28_7_PLR2LowSpeedControlCycle = 92807
    S29_0_NCMaster = 92900
    S29_1_ServerLinNCAxisTest = 92901
    S29_2_ServoLinkSpindleTest = 92902
    S29_3_OHSpecialFunction = 92903
    S29_4_NewOperationPanel = 92904
    S29_5_WithoutServoCard = 92905
    S29_6_PLC_SFCProgram = 92906
    S29_7_BuiltInPLC = 92907
    S30_0_CEMarking = 93000
    S30_1_SimplePitchCompensationSpecial = 93001
    S30_2_NCFrontDoor = 93002
    S30_3_SpecSelection = 93003
    S30_4_RSpec = 93004
    S30_5_NotRSpec = 93005
    S30_6_ThermalCompensationL2 = 93006
    S30_7_ThermalCompensationL1 = 93007
    S31_0_SteadyRestZBAxisControl = 93100
    S31_1_SteadyReadCrossSlideType = 93101
    S31_2_BLANK2 = 93102
    S31_3_BLANK3 = 93103
    S31_4_SteadyRestAutoTowAlongB = 93104
    S31_5_SteadyRestAutoTowAlong = 93105
    S31_6_SteadyRestSimpleTowAlongJog = 93106
    S31_7_SteadyRestSimpleTowAlong = 93107
    S32_0_ToolCenterPointControl = 93200
    S32_1_HiCutPro = 93201
    S32_2_HighSpeedInterpolation = 93202
    S32_3_NURBSCommand = 93203
    S32_4_SuperHiNC = 93204
    S32_5_SuperNURBSRotaryAxis = 93205
    S32_6_ToolID = 93206
    S32_7_BLANK7 = 93207
End Enum
''' <summary>
''' Sample codes that use CTools class in OKUMA.CLDATAPI.DLL library
''' </summary>
''' <remarks>Sample codes only. It does not detect all specifications of each machine</remarks>
Public Class DATAPI_CTools
    Private m_blnTestFullRange As Boolean = False

#Region "CTools.ToolData Example"
    ''' <summary>
    ''' Represent different function names to be used in CheckMethodSpec function
    ''' </summary>
    ''' <remarks></remarks>
    Public Enum MethodTypeEnum
        ReferenceToolOffset_123             'P100II/P200/P300L
        ReferenceToolOffset_123_BAxisControl 'P100II/P200
        ReferenceToolOffset_123_P300S       'P300S or newer
        ReferenceToolOffsetMultiTool_123    'P300L
        ReferenceToolOffset_12              'P300L
        ToolGroup                           'P100II/P200/P300L
        ToolGroup_P300S                     'P300S or newer
        ToolGroupMultiTool                  'P300L
        ToolLife                            'P100II/P200/P300L
        ToolLife_P300S                      'P300S or newer
        ToolLifeMultiTool                   'P300L
        ToolLifeStatus                      'P100II/P200/P300L
        ToolLifeStatus_P300S                'P300S or newer
        ToolLifeStatusMultiTool             'P300L
        ToolGaugeStatus                     'P100II/P200/P300L
        ToolGaugeStatus_P300S               'P300S or newer
        ToolGaugeStatusMultiTool            'P300L
        ToolOffset                          'P100II/P200/P300L
        ToolOffset_P300S                    'P300S or newer
        ToolWearOffset                      'P100II/P200/P300L
        ToolWearOffset_P300S                'P300S or newer
        ToolAdjustment_P300S                'P300S or newer
        NoseRCompensation                   'P100II/P200/P300L
        NoseRCompensation_P300S             'P300S or newer
        ToolPositionComment_P300S           'P300S or newer

    End Enum

#Region "CTools.ToolData per sub system Example"
    ''' <summary>
    ''' Access Tool data for each sub system related to magazine or turrets
    ''' </summary>
    ''' <remarks>Sample codes only. It does not detect all specifications of each machine</remarks>
    Public Sub ToolData()
        Dim enSubSystems() As Okuma.CLDATAPI.Enumerations.SubSystemEnum = System.Enum.GetValues(GetType(Okuma.CLDATAPI.Enumerations.SubSystemEnum))
        Dim enSubSystem As Okuma.CLDATAPI.Enumerations.SubSystemEnum

        For Each enSubSystem In enSubSystems
            If IsValidSubSystem(enSubSystem) Then
                'using sub system related to magzine or turrets if applicable
                If enSubSystem = Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_AL Or enSubSystem = Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_BL Or enSubSystem = Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_CL Then
                    If IsP300S_TD() Then
                        'call tool data functions for P300S controls
                        ToolData_P300S(enSubSystem)
                    ElseIf IsP300L() Then
                        'call tool data functions for P300L controls
                        ToolData_P300L(enSubSystem)
                    ElseIf IsP100P200() Then
                        'call tool data functions for P100II/P200 controls
                        ToolData_P100P200(enSubSystem)
                    End If
                End If
            End If
        Next
    End Sub
#End Region

#Region "CTools.ToolData per subsystem Example"

#Region "CTools.ToolData_P100P200 per subsystem Example"
    ''' <summary>
    ''' Access tool data For P100II/P200 controls:
    ''' </summary>
    ''' <param name="enSubSystem"></param>
    ''' <remarks>Sample codes only. It does not detect all specifications of each machine</remarks>
    Private Sub ToolData_P100P200(ByVal enSubSystem As Okuma.CLDATAPI.Enumerations.SubSystemEnum)
        Dim objSpec As Okuma.CLDATAPI.DataAPI.CSpec = New Okuma.CLDATAPI.DataAPI.CSpec
        Dim objTools As Okuma.CLDATAPI.DataAPI.CTools = New Okuma.CLDATAPI.DataAPI.CTools
        Dim objTurret As Okuma.CLDATAPI.DataAPI.CTurret = New Okuma.CLDATAPI.DataAPI.CTurret
        Dim objMachine As Okuma.CLDATAPI.DataAPI.CMachine = New Okuma.CLDATAPI.DataAPI.CMachine
        Dim enToolWearAxisIndexes() As Okuma.CLDATAPI.Enumerations.ToolWearOffsetAxisIndexEnum = System.Enum.GetValues(GetType(Okuma.CLDATAPI.Enumerations.ToolWearOffsetAxisIndexEnum))
        Dim enNoseRCompensationAxisIndexes() As Okuma.CLDATAPI.Enumerations.NoseRCompensationAxisIndexEnum = System.Enum.GetValues(GetType(Okuma.CLDATAPI.Enumerations.NoseRCompensationAxisIndexEnum))
        Dim enToolWearAxisIndex As Okuma.CLDATAPI.Enumerations.ToolWearOffsetAxisIndexEnum
        Dim enToolOffsetAxisIndexes() As Okuma.CLDATAPI.Enumerations.ToolOffsetAxisIndexEnum = System.Enum.GetValues(GetType(Okuma.CLDATAPI.Enumerations.ToolOffsetAxisIndexEnum))
        Dim enToolOffsetAxisIndex As Okuma.CLDATAPI.Enumerations.ToolOffsetAxisIndexEnum
        Dim enNoseRCompensationAxisIndex As Okuma.CLDATAPI.Enumerations.NoseRCompensationAxisIndexEnum
        Dim enToolLifeConditions() As Okuma.CLDATAPI.Enumerations.ToolLifeConditionEnum = System.Enum.GetValues(GetType(Okuma.CLDATAPI.Enumerations.ToolLifeConditionEnum))
        Dim enToolLifeCondition As Okuma.CLDATAPI.Enumerations.ToolLifeConditionEnum
        Dim intCount As Integer
        Dim intToolStation As Integer
        Dim intOffsetIndex As Integer
        Dim blnBAxixControlSpec As Boolean = False

        blnBAxixControlSpec = objSpec.GetSpecCode(8, 7)

        'set sub system to access tool data related to that sub system only
        objTools.SetSubSystem(enSubSystem)
        intCount = objTools.GetMaxToolOffset()

        'Tool Offset settings by offset index
        For intOffsetIndex = 1 To intCount
            For Each enToolOffsetAxisIndex In enToolOffsetAxisIndexes
                If CheckMethodSpec(MethodTypeEnum.ToolOffset, intAxisIndex:=enToolOffsetAxisIndex, enSubSystem:=enSubSystem) Then
                    ToolOffset(enSubSystem, intOffsetIndex, enToolOffsetAxisIndex, 0.01)
                End If
            Next
        Next

        'Nose-R Compensation settings by offset index
        If CheckMethodSpec(MethodTypeEnum.NoseRCompensation, enSubSystem:=enSubSystem) Then
            For intOffsetIndex = 1 To intCount
                For Each enNoseRCompensationAxisIndex In enNoseRCompensationAxisIndexes
                    NoseRCompensation(enSubSystem, intOffsetIndex, enNoseRCompensationAxisIndex, 0.01)
                Next
            Next
        End If

        'Tool Wear settings by offset index
        If CheckMethodSpec(MethodTypeEnum.ToolWearOffset, enSubSystem:=enSubSystem) Then
            For intOffsetIndex = 1 To intCount
                For Each enToolWearAxisIndex In enToolWearAxisIndexes
                    ToolWear(enSubSystem, intOffsetIndex, enToolWearAxisIndex, 0.01)
                Next
            Next
        End If

        'get number of stations for turret based on current sub system
        objTurret.SetSubSystem(enSubSystem)
        intCount = objTurret.GetMaxToolPots(GetTurretBySubSystem(enSubSystem))
        'access tool life by tool/station number
        For intToolStation = 1 To intCount
            For Each enToolOffsetAxisIndex In enToolOffsetAxisIndexes
                If CheckMethodSpec(MethodTypeEnum.ToolLife, intToolStation, enToolOffsetAxisIndex, -1, enSubSystem) Then ToolLife(enSubSystem, enToolLifeCondition, intToolStation, Okuma.CLDATAPI.Enumerations.ToolEdgeEnum.ToolEdge_01, dblActualValue:=100, dblSetValue:=100)
                If CheckMethodSpec(MethodTypeEnum.ToolLifeStatus, intToolStation, enToolOffsetAxisIndex, -1, enSubSystem) Then ToolLifeStatus(enSubSystem, intToolStation, Okuma.CLDATAPI.Enumerations.ToolEdgeEnum.ToolEdge_01, Okuma.CLDATAPI.Enumerations.ToolLifeStatusEnum.OK)
                If CheckMethodSpec(MethodTypeEnum.ToolGaugeStatus, intToolStation, enToolOffsetAxisIndex, 0, enSubSystem) Then ToolGaugeStatus(enSubSystem, intToolStation, Okuma.CLDATAPI.Enumerations.ToolEdgeEnum.ToolEdge_01, Okuma.CLDATAPI.Enumerations.ToolGaugeStatusEnum.OK)
            Next
        Next

        'get number of stations for turret based on current sub system
        objTurret.SetSubSystem(enSubSystem)
        intCount = objTurret.GetMaxToolPots(GetTurretBySubSystem(enSubSystem))
        For intToolStation = 1 To intCount

            If blnBAxixControlSpec Then
                If CheckMethodSpec(MethodTypeEnum.ReferenceToolOffset_123_BAxisControl, enPrincipalAxis:=Okuma.CLDATAPI.Enumerations.PrincipalAxisEnum.SpindleAxis_1, enBAxisCuttingPosition:=Okuma.CLDATAPI.Enumerations.BAxisCuttingPositionEnum.BasePosition, enSubSystem:=enSubSystem) Then ReferenceToolOffset_123(enSubSystem, Okuma.CLDATAPI.Enumerations.PrincipalAxisEnum.SpindleAxis_1, Okuma.CLDATAPI.Enumerations.BAxisCuttingPositionEnum.BasePosition, intToolNo:=intToolStation, intValue:=1)
                If CheckMethodSpec(MethodTypeEnum.ReferenceToolOffset_123_BAxisControl, enPrincipalAxis:=Okuma.CLDATAPI.Enumerations.PrincipalAxisEnum.SpindleAxis_1, enBAxisCuttingPosition:=Okuma.CLDATAPI.Enumerations.BAxisCuttingPositionEnum.VerticalPosition, enSubSystem:=enSubSystem) Then ReferenceToolOffset_123(enSubSystem, Okuma.CLDATAPI.Enumerations.PrincipalAxisEnum.SpindleAxis_1, Okuma.CLDATAPI.Enumerations.BAxisCuttingPositionEnum.BasePosition, intToolNo:=intToolStation, intValue:=1)
                If CheckMethodSpec(MethodTypeEnum.ReferenceToolOffset_123_BAxisControl, enPrincipalAxis:=Okuma.CLDATAPI.Enumerations.PrincipalAxisEnum.SpindleAxis_2, enBAxisCuttingPosition:=Okuma.CLDATAPI.Enumerations.BAxisCuttingPositionEnum.BasePosition, enSubSystem:=enSubSystem) Then ReferenceToolOffset_123(enSubSystem, Okuma.CLDATAPI.Enumerations.PrincipalAxisEnum.SpindleAxis_1, Okuma.CLDATAPI.Enumerations.BAxisCuttingPositionEnum.BasePosition, intToolNo:=intToolStation, intValue:=1)
                If CheckMethodSpec(MethodTypeEnum.ReferenceToolOffset_123_BAxisControl, enPrincipalAxis:=Okuma.CLDATAPI.Enumerations.PrincipalAxisEnum.SpindleAxis_2, enBAxisCuttingPosition:=Okuma.CLDATAPI.Enumerations.BAxisCuttingPositionEnum.VerticalPosition, enSubSystem:=enSubSystem) Then ReferenceToolOffset_123(enSubSystem, Okuma.CLDATAPI.Enumerations.PrincipalAxisEnum.SpindleAxis_1, Okuma.CLDATAPI.Enumerations.BAxisCuttingPositionEnum.BasePosition, intToolNo:=intToolStation, intValue:=1)
            End If

            If CheckMethodSpec(MethodTypeEnum.ReferenceToolOffset_123, intToolNo:=intToolStation, enSubSystem:=enSubSystem) Then ReferenceToolOffset_123(enSubSystem, intToolStation, Okuma.CLDATAPI.Enumerations.ToolEdgeEnum.ToolEdge_01, 1)
            If CheckMethodSpec(MethodTypeEnum.ToolGroup, intToolNo:=intToolStation, enSubSystem:=enSubSystem) Then ToolGroup(enSubSystem, intToolStation, Okuma.CLDATAPI.Enumerations.ToolEdgeEnum.ToolEdge_01, 10)
        Next
    End Sub

#End Region

#Region "CTools.ToolData_P300L per subsystem Example"
    ''' <summary>
    ''' Access tool data For P300L controls:
    ''' </summary>
    ''' <param name="enSubSystem"></param>
    ''' <remarks>Sample codes only. It does not detect all specifications of each machine</remarks>
    Private Sub ToolData_P300L(ByVal enSubSystem As Okuma.CLDATAPI.Enumerations.SubSystemEnum)
        Dim objSpec As Okuma.CLDATAPI.DataAPI.CSpec = New Okuma.CLDATAPI.DataAPI.CSpec
        Dim objTools As Okuma.CLDATAPI.DataAPI.CTools = New Okuma.CLDATAPI.DataAPI.CTools
        Dim objTurret As Okuma.CLDATAPI.DataAPI.CTurret = New Okuma.CLDATAPI.DataAPI.CTurret
        Dim objMachine As Okuma.CLDATAPI.DataAPI.CMachine = New Okuma.CLDATAPI.DataAPI.CMachine
        Dim enToolWearAxisIndexes() As Okuma.CLDATAPI.Enumerations.ToolWearOffsetAxisIndexEnum = System.Enum.GetValues(GetType(Okuma.CLDATAPI.Enumerations.ToolWearOffsetAxisIndexEnum))
        Dim enNoseRCompensationAxisIndexes() As Okuma.CLDATAPI.Enumerations.NoseRCompensationAxisIndexEnum = System.Enum.GetValues(GetType(Okuma.CLDATAPI.Enumerations.NoseRCompensationAxisIndexEnum))
        Dim enToolWearAxisIndex As Okuma.CLDATAPI.Enumerations.ToolWearOffsetAxisIndexEnum
        Dim enToolOffsetAxisIndexes() As Okuma.CLDATAPI.Enumerations.ToolOffsetAxisIndexEnum = System.Enum.GetValues(GetType(Okuma.CLDATAPI.Enumerations.ToolOffsetAxisIndexEnum))
        Dim enToolOffsetAxisIndex As Okuma.CLDATAPI.Enumerations.ToolOffsetAxisIndexEnum
        Dim enNoseRCompensationAxisIndex As Okuma.CLDATAPI.Enumerations.NoseRCompensationAxisIndexEnum
        Dim enToolLifeConditions() As Okuma.CLDATAPI.Enumerations.ToolLifeConditionEnum = System.Enum.GetValues(GetType(Okuma.CLDATAPI.Enumerations.ToolLifeConditionEnum))
        Dim enToolLifeCondition As Okuma.CLDATAPI.Enumerations.ToolLifeConditionEnum
        Dim intCount As Integer
        Dim intToolList() As Integer
        Dim intToolEdges() As Integer
        Dim intToolEdge As Integer
        Dim intCuttingPositions() As Integer
        Dim intCuttingPosition As Integer
        Dim blnMultiToolSpec As Boolean
        Dim intOffsetIndex As Integer
        Dim intToolStation As Integer

        'set sub system to access tool data related to that sub system only
        objTools.SetSubSystem(enSubSystem)
        intCount = objTools.GetMaxToolOffset()

        blnMultiToolSpec = objSpec.GetBSpecCode(24, 7)

        'Tool Offset settings by offset index
        For intOffsetIndex = 1 To intCount
            For Each enToolOffsetAxisIndex In enToolOffsetAxisIndexes
                If CheckMethodSpec(MethodTypeEnum.ToolOffset, intAxisIndex:=enToolOffsetAxisIndex, enSubSystem:=enSubSystem) Then
                    ToolOffset(enSubSystem, intOffsetIndex, enToolOffsetAxisIndex, 0.01)
                End If
            Next
        Next

        'Nose-R Compensation settings by offset index
        If CheckMethodSpec(MethodTypeEnum.NoseRCompensation, enSubSystem:=enSubSystem) Then
            For intIndex = 1 To intCount
                For Each enNoseRCompensationAxisIndex In enNoseRCompensationAxisIndexes
                    NoseRCompensation(enSubSystem, intIndex, enNoseRCompensationAxisIndex, 0.01)
                Next
            Next
        End If

        'Tool Wear settings by offset index
        If CheckMethodSpec(MethodTypeEnum.ToolWearOffset, enSubSystem:=enSubSystem) Then
            For intIndex = 1 To intCount
                For Each enToolWearAxisIndex In enToolWearAxisIndexes
                    ToolWear(enSubSystem, intIndex, enToolWearAxisIndex, 0.01)
                Next
            Next
        End If

        'set sub system to access tool data related to that sub system only
        'Tool Life Management: Tool Life, Tool Life STatus, Tool Gauge status
        objTurret.SetSubSystem(enSubSystem)
        intCount = objTurret.GetMaxToolPots(GetTurretBySubSystem(enSubSystem))
        For intToolStation = 1 To intCount
            For Each enToolLifeCondition In enToolLifeConditions
                'handle multi tool specification. One tool has 8 edges
                If blnMultiToolSpec Then
                    For intEdgeNo As Integer = 1 To 8
                        If CheckMethodSpec(MethodTypeEnum.ToolLifeMultiTool, intToolNo:=intToolStation, enSubSystem:=enSubSystem) Then ToolLife(enSubSystem, enToolLifeCondition, intToolStation, intEdgeNo, dblActualValue:=100, dblSetValue:=100)
                        If CheckMethodSpec(MethodTypeEnum.ToolLifeStatusMultiTool, intToolNo:=intToolStation, enSubSystem:=enSubSystem) Then ToolLifeStatus(enSubSystem, intToolStation, intEdgeNo, Okuma.CLDATAPI.Enumerations.ToolLifeStatusEnum.OK)
                        If CheckMethodSpec(MethodTypeEnum.ToolGaugeStatusMultiTool, intToolNo:=intToolStation, enSubSystem:=enSubSystem) Then ToolGaugeStatus(enSubSystem, intToolStation, intEdgeNo, Okuma.CLDATAPI.Enumerations.ToolGaugeStatusEnum.OK)
                    Next
                Else
                    If CheckMethodSpec(MethodTypeEnum.ToolLife, intToolStation, enToolOffsetAxisIndex, -1, enSubSystem) Then ToolLife(enSubSystem, enToolLifeCondition, intToolStation, Okuma.CLDATAPI.Enumerations.ToolEdgeEnum.ToolEdge_01, dblActualValue:=100, dblSetValue:=100)
                    If CheckMethodSpec(MethodTypeEnum.ToolLifeStatus, intToolStation, enToolOffsetAxisIndex, -1, enSubSystem) Then ToolLifeStatus(enSubSystem, intToolStation, Okuma.CLDATAPI.Enumerations.ToolEdgeEnum.ToolEdge_01, Okuma.CLDATAPI.Enumerations.ToolLifeStatusEnum.OK)
                    If CheckMethodSpec(MethodTypeEnum.ToolGaugeStatus, intToolStation, enToolOffsetAxisIndex, 0, enSubSystem) Then ToolGaugeStatus(enSubSystem, intToolStation, Okuma.CLDATAPI.Enumerations.ToolEdgeEnum.ToolEdge_01, Okuma.CLDATAPI.Enumerations.ToolGaugeStatusEnum.OK)
                End If
            Next
        Next

        'set sub system to access tool data related to that sub system only
        'Tool Life Management: Referent Tool Offset 1/2/3, Tool Group
        objTurret.SetSubSystem(enSubSystem)
        intCount = objTurret.GetMaxToolPots(GetTurretBySubSystem(enSubSystem))
        For intToolStation = 1 To intCount
            If blnMultiToolSpec Then
                For intEdgeNo As Integer = 1 To 8
                    If CheckMethodSpec(MethodTypeEnum.ReferenceToolOffsetMultiTool_123, intToolNo:=intToolStation, enSubSystem:=enSubSystem) Then ReferenceToolOffset_123(enSubSystem, intToolStation, intEdgeNo, 1)
                    If CheckMethodSpec(MethodTypeEnum.ToolGroupMultiTool, intToolNo:=intToolStation, enSubSystem:=enSubSystem) Then ToolGroup(enSubSystem, intToolStation, intEdgeNo, 10)
                Next
            Else
                If CheckMethodSpec(MethodTypeEnum.ReferenceToolOffset_123, intToolNo:=intToolStation, enSubSystem:=enSubSystem) Then ReferenceToolOffset_123(enSubSystem, intToolStation, Okuma.CLDATAPI.Enumerations.ToolEdgeEnum.ToolEdge_01, 1)
                If CheckMethodSpec(MethodTypeEnum.ToolGroup, intToolNo:=intToolStation, enSubSystem:=enSubSystem) Then ToolGroup(enSubSystem, intToolStation, Okuma.CLDATAPI.Enumerations.ToolEdgeEnum.ToolEdge_01, 10)
            End If
        Next

        'remove all tools
        ClearTool()

        'register tools
        RegisterTools_P300L(GeneratedTestValues(1, GetToolNos(enSubSystem)), enSubSystem)

        'get all tools currently registered with the system. Tools can be attached in ATC Magazine or in turret stations
        intToolList = objTools.GetToolList(Okuma.CLDATAPI.Enumerations.ToolListTypeEnum.AllTools)

        For Each intToolNo In intToolList
            If objTools.IsMultiEdgesTool(intToolNo) Then
                'get all registered tool edges if applicable for Multi-edges tools
                intToolEdges = objTools.GetRegisteredToolEdges(intToolNo)
                For Each intToolEdge In intToolEdges
                    'get all cutting positions for each tool/edge number
                    intCuttingPositions = objTools.GetRegisteredCuttingPositions(intToolNo, intToolEdge)

                    'setting tool data that are related directly to registered tool number. 
                    ' A new tool concept on P300 control, a registered tool can be assigned to any pot on the ATC magazine or turrets.
                    For Each intCuttingPosition In intCuttingPositions
                        ReferenceToolOffset_12(enSubSystem, intToolNo, intToolEdge, intCuttingPosition, 1)
                        SpindleAxisMode(enSubSystem, intToolNo, intToolEdge, intCuttingPosition)
                    Next
                Next
            End If
        Next
    End Sub
#End Region

#Region "CTools.ToolData_P300S per subsystem Example"
    ''' <summary>
    ''' For P300S control, this function will access tool data 
    ''' given tool number, axis index, edge number, cuttting position, and setting value if applicable
    ''' </summary>
    ''' <remarks>
    ''' Tool data depends on registered tool number.  A registered tool can be assigned to either turret or magazine.
    ''' </remarks>
    Private Sub ToolData_P300S(ByVal enSubSystem As Okuma.CLDATAPI.Enumerations.SubSystemEnum)
        Dim objTools As Okuma.CLDATAPI.DataAPI.CTools = New Okuma.CLDATAPI.DataAPI.CTools
        Dim objATC As Okuma.CLDATAPI.DataAPI.CATC = New Okuma.CLDATAPI.DataAPI.CATC
        Dim intToolList() As Integer
        Dim intToolNo As Integer
        Dim enToolWearAxisIndexes() As Okuma.CLDATAPI.Enumerations.ToolWearOffsetAxisIndexEnum = System.Enum.GetValues(GetType(Okuma.CLDATAPI.Enumerations.ToolWearOffsetAxisIndexEnum))
        Dim enNoseRCompensationAxisIndexes() As Okuma.CLDATAPI.Enumerations.NoseRCompensationAxisIndexEnum = System.Enum.GetValues(GetType(Okuma.CLDATAPI.Enumerations.NoseRCompensationAxisIndexEnum))
        Dim enToolWearAxisIndex As Okuma.CLDATAPI.Enumerations.ToolWearOffsetAxisIndexEnum
        Dim enToolOffsetAxisIndexes() As Okuma.CLDATAPI.Enumerations.ToolOffsetAxisIndexEnum = System.Enum.GetValues(GetType(Okuma.CLDATAPI.Enumerations.ToolOffsetAxisIndexEnum))
        Dim enToolOffsetAxisIndex As Okuma.CLDATAPI.Enumerations.ToolOffsetAxisIndexEnum
        Dim enNoseRCompensationAxisIndex As Okuma.CLDATAPI.Enumerations.NoseRCompensationAxisIndexEnum
        Dim enToolLifeConditions() As Okuma.CLDATAPI.Enumerations.ToolLifeConditionEnum = System.Enum.GetValues(GetType(Okuma.CLDATAPI.Enumerations.ToolLifeConditionEnum))
        Dim enToolLifeCondition As Okuma.CLDATAPI.Enumerations.ToolLifeConditionEnum

        Dim intToolEdges() As Integer
        Dim intToolEdge As Integer
        Dim intCuttingPositions() As Integer
        Dim intCuttingPosition As Integer
        Dim dblValue As Double

        'remove all tools
        ClearTool()

        'register tools
        RegisterTools_P300S(GeneratedTestValues(1, GetToolNos(enSubSystem)))

        'get all tools currently registered with the system. Tools can be attached in ATC Magazine or in turret stations
        intToolList = objTools.GetToolList(Okuma.CLDATAPI.Enumerations.ToolListTypeEnum.AllTools)

        For Each intToolNo In intToolList

            If objTools.IsMultiEdgesTool(intToolNo) Then

                'get all registered tool edges if applicable for Multi-edges tools
                intToolEdges = objTools.GetRegisteredToolEdges(intToolNo)
                For Each intToolEdge In intToolEdges

                    'get all cutting positions for each tool/edge number
                    intCuttingPositions = objTools.GetRegisteredCuttingPositions(intToolNo, intToolEdge)
                    For Each intCuttingPosition In intCuttingPositions
                        'Tool Wear offset by registered tool number
                        For Each enToolWearAxisIndex In enToolWearAxisIndexes
                            ToolWearOffset_P300S(enSubSystem, intToolNo, enToolWearAxisIndex, intToolEdge, intCuttingPosition, dblValue)
                        Next

                        'Nose R compensation offset by registered tool number
                        For Each enNoseRCompensationAxisIndex In enNoseRCompensationAxisIndexes
                            NoseRCompensation_P300S(enSubSystem, intToolNo, enNoseRCompensationAxisIndex, intToolEdge, intCuttingPosition, dblValue)
                        Next

                        'Tool Length Offset by registered tool number
                        For Each enToolOffsetAxisIndex In enToolOffsetAxisIndexes
                            If enToolOffsetAxisIndex = Okuma.CLDATAPI.Enumerations.ToolOffsetAxisIndexEnum.YI_Axis Then
                                If CheckMethodSpec(MethodTypeEnum.ToolOffset_P300S, intAxisIndex:=enToolOffsetAxisIndex, enSubSystem:=enSubSystem) Then
                                    'YI axis is only applicable to register for Magazine/H1/A turret
                                    If objATC.GetToolPot(intToolNo).enToolLocation = Okuma.CLDATAPI.Enumerations.ToolPotLocationEnum.A_Turret Then
                                        ToolOffset_P300S(intToolNo, enToolOffsetAxisIndex, intToolEdge, intCuttingPosition, dblValue)
                                    End If
                                End If
                            Else
                                ToolOffset_P300S(intToolNo, enToolOffsetAxisIndex, intToolEdge, intCuttingPosition, dblValue)
                            End If
                        Next

                        'Tool Adjustment by registered tool number
                        For Each enToolOffsetAxisIndex In enToolOffsetAxisIndexes
                            'YI axis is only applicable to register for Magazine/H1/A turret
                            If enToolOffsetAxisIndex = Okuma.CLDATAPI.Enumerations.ToolOffsetAxisIndexEnum.YI_Axis Then
                                If CheckMethodSpec(MethodTypeEnum.ToolAdjustment_P300S, intAxisIndex:=enToolOffsetAxisIndex, enSubSystem:=enSubSystem) Then
                                    'YI axis is only applicable to register for Magazine/H1/A turret
                                    If objATC.GetToolPot(intToolNo).enToolLocation = Okuma.CLDATAPI.Enumerations.ToolPotLocationEnum.A_Turret Then
                                        ToolAdjustment_P300S(enSubSystem, intToolNo, enToolOffsetAxisIndex, intToolEdge, intCuttingPosition, dblValue)
                                    End If
                                End If
                            Else
                                ToolAdjustment_P300S(enSubSystem, intToolNo, enToolOffsetAxisIndex, intToolEdge, intCuttingPosition, dblValue)
                            End If
                        Next

                        'Tool group by registered tool number, edge no, and cutting position
                        If CheckMethodSpec(MethodTypeEnum.ToolGroup_P300S, enSubSystem:=enSubSystem) Then
                            ToolGroup(enSubSystem, intToolNo, intToolEdge, intCuttingPosition)
                        End If

                        'Tool position comment by registered tool number, edge no, and cutting position
                        If CheckMethodSpec(MethodTypeEnum.ToolPositionComment_P300S, enSubSystem:=enSubSystem) Then
                            ToolPositionComment(enSubSystem, intToolNo, intToolEdge, intCuttingPosition)
                        End If
                    Next

                    'Tool Life Status by registered tool number
                    If CheckMethodSpec(MethodTypeEnum.ToolLife_P300S, enSubSystem:=enSubSystem) Then
                        For Each enToolOffsetAxisIndex In enToolOffsetAxisIndexes
                            ToolLifeStatus(enSubSystem, intToolNo, intToolEdge, Okuma.CLDATAPI.Enumerations.ToolLifeStatusEnum.OK)
                        Next
                    End If

                    If CheckMethodSpec(MethodTypeEnum.ToolGaugeStatus_P300S, enSubSystem:=enSubSystem) Then
                        'Tool Gauge Status by registered tool number
                        For Each enToolOffsetAxisIndex In enToolOffsetAxisIndexes
                            ToolGaugeStatus(enSubSystem, intToolNo, intToolEdge, Okuma.CLDATAPI.Enumerations.ToolGaugeStatusEnum.OK)
                        Next
                    End If

                    'Tool Life by registered tool number
                    If CheckMethodSpec(MethodTypeEnum.ToolLife_P300S, enSubSystem:=enSubSystem) Then
                        For Each enToolLifeCondition In enToolLifeConditions
                            ToolLife(enSubSystem, enToolLifeCondition, intToolNo, intToolEdge, 100, 100)
                        Next
                    End If

                    'Reference Tool group offset 1/2/3 by registered tool number
                    If CheckMethodSpec(MethodTypeEnum.ReferenceToolOffset_123_P300S, enSubSystem:=enSubSystem) Then
                        For Each enToolLifeCondition In enToolLifeConditions
                            ReferenceToolOffset_123(enSubSystem, intToolNo, intToolEdge, 10)
                        Next
                    End If

                Next

            Else
                'For all non multi-edge tools

                'get all cutting positions for each tool and edge 1
                intCuttingPositions = objTools.GetRegisteredCuttingPositions(intToolNo, Okuma.CLDATAPI.Enumerations.ToolEdgeEnum.ToolEdge_01)

                For Each intCuttingPosition In intCuttingPositions
                    'Tool Wear offset by registered tool number
                    For Each enToolWearAxisIndex In enToolWearAxisIndexes
                        ToolWearOffset_P300S(enSubSystem, intToolNo, enToolWearAxisIndex, Okuma.CLDATAPI.Enumerations.ToolEdgeEnum.ToolEdge_01, intCuttingPosition, dblValue)
                    Next

                    'Nose R compensation offset by registered tool number
                    For Each enNoseRCompensationAxisIndex In enNoseRCompensationAxisIndexes
                        NoseRCompensation_P300S(enSubSystem, intToolNo, enNoseRCompensationAxisIndex, Okuma.CLDATAPI.Enumerations.ToolEdgeEnum.ToolEdge_01, intCuttingPosition, dblValue)
                    Next

                    'Tool Length Offset by registered tool number
                    For Each enToolOffsetAxisIndex In enToolOffsetAxisIndexes
                        If enToolOffsetAxisIndex = Okuma.CLDATAPI.Enumerations.ToolOffsetAxisIndexEnum.YI_Axis Then
                            If CheckMethodSpec(MethodTypeEnum.ToolOffset_P300S, intAxisIndex:=enToolOffsetAxisIndex, enSubSystem:=enSubSystem) Then
                                'YI axis is only applicable to register for Magazine/H1/A turret
                                If objATC.GetToolPot(intToolNo).enToolLocation = Okuma.CLDATAPI.Enumerations.ToolPotLocationEnum.A_Turret Then
                                    ToolOffset_P300S(intToolNo, enToolOffsetAxisIndex, Okuma.CLDATAPI.Enumerations.ToolEdgeEnum.ToolEdge_01, intCuttingPosition, dblValue)
                                End If
                            End If
                        Else
                            ToolOffset_P300S(intToolNo, enToolOffsetAxisIndex, Okuma.CLDATAPI.Enumerations.ToolEdgeEnum.ToolEdge_01, intCuttingPosition, dblValue)
                        End If
                    Next

                    'Tool Adjustment by registered tool number
                    For Each enToolOffsetAxisIndex In enToolOffsetAxisIndexes
                        If enToolOffsetAxisIndex = Okuma.CLDATAPI.Enumerations.ToolOffsetAxisIndexEnum.YI_Axis Then
                            If CheckMethodSpec(MethodTypeEnum.ToolAdjustment_P300S, intAxisIndex:=enToolOffsetAxisIndex, enSubSystem:=enSubSystem) Then
                                'YI axis is only applicable to register for Magazine/H1/A turret
                                If objATC.GetToolPot(intToolNo).enToolLocation = Okuma.CLDATAPI.Enumerations.ToolPotLocationEnum.A_Turret Then
                                    ToolAdjustment_P300S(enSubSystem, intToolNo, enToolOffsetAxisIndex, Okuma.CLDATAPI.Enumerations.ToolEdgeEnum.ToolEdge_01, intCuttingPosition, dblValue)
                                End If
                            End If
                        Else
                            ToolAdjustment_P300S(enSubSystem, intToolNo, enToolOffsetAxisIndex, Okuma.CLDATAPI.Enumerations.ToolEdgeEnum.ToolEdge_01, intCuttingPosition, dblValue)
                        End If
                    Next
                Next

                'Tool Life Status by registered tool number
                If CheckMethodSpec(MethodTypeEnum.ToolLife_P300S, enSubSystem:=enSubSystem) Then
                    For Each enToolOffsetAxisIndex In enToolOffsetAxisIndexes
                        ToolLifeStatus(enSubSystem, intToolNo, Okuma.CLDATAPI.Enumerations.ToolEdgeEnum.ToolEdge_01, Okuma.CLDATAPI.Enumerations.ToolLifeStatusEnum.OK)
                    Next
                End If

                'Tool Gauge Status by registered tool number
                If CheckMethodSpec(MethodTypeEnum.ToolGaugeStatus_P300S, enSubSystem:=enSubSystem) Then
                    For Each enToolOffsetAxisIndex In enToolOffsetAxisIndexes
                        ToolGaugeStatus(enSubSystem, intToolNo, Okuma.CLDATAPI.Enumerations.ToolEdgeEnum.ToolEdge_01, Okuma.CLDATAPI.Enumerations.ToolGaugeStatusEnum.OK)
                    Next
                End If

                'Tool Life by registered tool number
                If CheckMethodSpec(MethodTypeEnum.ToolLife_P300S, enSubSystem:=enSubSystem) Then
                    For Each enToolLifeCondition In enToolLifeConditions
                        ToolLife(enSubSystem, enToolLifeCondition, intToolNo, Okuma.CLDATAPI.Enumerations.ToolEdgeEnum.ToolEdge_01, 100, 100)
                    Next
                End If

                'Reference Tool group offset 1/2/3 by registered tool number
                If CheckMethodSpec(MethodTypeEnum.ReferenceToolOffset_123_P300S, enSubSystem:=enSubSystem) Then
                    For Each enToolLifeCondition In enToolLifeConditions
                        ReferenceToolOffset_123(enSubSystem, intToolNo, Okuma.CLDATAPI.Enumerations.ToolEdgeEnum.ToolEdge_01, 10)
                    Next
                End If
            End If

        Next

    End Sub
#End Region

#End Region

#Region "CTools.Get-Set-ToolWearOffset_P300S Example"
    ''' <summary>
    ''' Get/Set tool wear offset given registered tool number, axis index, edge number, cuttting position, and setting value
    ''' </summary>
    ''' <remarks>
    ''' <para>For P300S and IsLTMIMSpecOn = True and TD Mode = True,
    ''' each registered tool number (Not a turret station number) 
    ''' can support tool offset per edge and cutting position if it is applicable. </para>
    ''' </remarks>
    Private Sub ToolWearOffset_P300S(ByVal enSubSystem As Okuma.CLDATAPI.Enumerations.SubSystemEnum, _
                         intToolNo As Integer, _
                         enAxisIndex As Okuma.CLDATAPI.Enumerations.ToolWearOffsetAxisIndexEnum, _
                         enEdgeNo As Okuma.CLDATAPI.Enumerations.ToolEdgeEnum, _
                         enToolCuttingPosition As Okuma.CLDATAPI.Enumerations.ToolCuttingPositionEnum, _
                         dblValue As Double)

        Dim objSpec As Okuma.CLDATAPI.DataAPI.CSpec = New Okuma.CLDATAPI.DataAPI.CSpec
        Dim objTools As Okuma.CLDATAPI.DataAPI.CTools = New Okuma.CLDATAPI.DataAPI.CTools
        Dim objMachine As Okuma.CLDATAPI.DataAPI.CMachine = New Okuma.CLDATAPI.DataAPI.CMachine

        Dim blnTDMode As Boolean = False

        objMachine.SetSubSystem(enSubSystem)
        objTools.SetSubSystem(enSubSystem)

        blnTDMode = objMachine.GetTDMode()

        If IsP300S() Then
            If blnTDMode Then
                If objTools.IsRegisteredTool(intToolNo) Then
                    objTools.SetToolWearOffset(intToolNo, enAxisIndex, enEdgeNo, enToolCuttingPosition, 0) 'clear value
                    objTools.AddToolWearOffset(intToolNo, enAxisIndex, enEdgeNo, enToolCuttingPosition, dblValue) ' added to current value
                    objTools.GetToolWearOffset(intToolNo, enAxisIndex, enEdgeNo, enToolCuttingPosition) ' get current value
                End If
            Else
                Throw New ApplicationException("Not supported in TD mode for P300S control")
            End If
        End If
    End Sub
#End Region

#Region "CTools.Get-Set-NoseRCompensation_P300S Example"
    ''' <summary>
    ''' Get/Set/Add Nose R Compensation given registered tool number, axis index, edge number, cuttting position, and setting value
    ''' </summary>
    ''' <remarks>
    ''' <para>For P300S and IsLTMIMSpecOn = True and TD Mode = True, 
    ''' each registered tool number (Not a turret station number) 
    ''' can support tool offset per edge and cutting position if it is applicable. </para>
    ''' </remarks>
    Private Sub NoseRCompensation_P300S(ByVal enSubSystem As Okuma.CLDATAPI.Enumerations.SubSystemEnum, _
                         intToolNo As Integer, _
                         enAxisIndex As Okuma.CLDATAPI.Enumerations.NoseRCompensationAxisIndexEnum, _
                         enEdgeNo As Okuma.CLDATAPI.Enumerations.ToolEdgeEnum, _
                         enToolCuttingPosition As Okuma.CLDATAPI.Enumerations.ToolCuttingPositionEnum, _
                         dblValue As Double)

        Dim objSpec As Okuma.CLDATAPI.DataAPI.CSpec = New Okuma.CLDATAPI.DataAPI.CSpec
        Dim objTools As Okuma.CLDATAPI.DataAPI.CTools = New Okuma.CLDATAPI.DataAPI.CTools
        Dim objMachine As Okuma.CLDATAPI.DataAPI.CMachine = New Okuma.CLDATAPI.DataAPI.CMachine

        Dim blnTDMode As Boolean = False

        objMachine.SetSubSystem(enSubSystem)
        objTools.SetSubSystem(enSubSystem)

        blnTDMode = objMachine.GetTDMode()

        If IsP300S() Then
            If blnTDMode Then
                objTools.SetNoseRCompensation(intToolNo, enAxisIndex, enEdgeNo, enToolCuttingPosition, 0) 'clear value
                objTools.AddNoseRCompensation(intToolNo, enAxisIndex, enEdgeNo, enToolCuttingPosition, dblValue) ' added to current value
                objTools.GetNoseRCompensation(intToolNo, enAxisIndex, enEdgeNo, enToolCuttingPosition) ' get current value
            End If
        Else
            Throw New ApplicationException("Not supported in TD mode for P300S control")
        End If
    End Sub
#End Region

#Region "CTools.Get-Set-ToolAdjustment_P300S Example"
    ''' <summary>
    ''' Get/Set tool Adjusment given registered tool number, axis index, edge number, cuttting position, and setting value
    ''' </summary>
    ''' <remarks>
    ''' <para>For P300S and IsLTMIMSpecOn = True and TD Mode = True, 
    ''' each registered tool number (Not a turret station number) 
    ''' can support tool offset per edge and cutting position if it is applicable. </para>
    ''' </remarks>
    Private Sub ToolAdjustment_P300S(ByVal enSubSystem As Okuma.CLDATAPI.Enumerations.SubSystemEnum, _
                         intToolNo As Integer, _
                         enAxisIndex As Okuma.CLDATAPI.Enumerations.ToolOffsetAxisIndexEnum, _
                         enEdgeNo As Okuma.CLDATAPI.Enumerations.ToolEdgeEnum, _
                         enToolCuttingPosition As Okuma.CLDATAPI.Enumerations.ToolCuttingPositionEnum, _
                         dblValue As Double)

        Dim objSpec As Okuma.CLDATAPI.DataAPI.CSpec = New Okuma.CLDATAPI.DataAPI.CSpec
        Dim objTools As Okuma.CLDATAPI.DataAPI.CTools = New Okuma.CLDATAPI.DataAPI.CTools
        Dim objMachine As Okuma.CLDATAPI.DataAPI.CMachine = New Okuma.CLDATAPI.DataAPI.CMachine

        Dim blnTDMode As Boolean = False

        objMachine.SetSubSystem(enSubSystem)
        objTools.SetSubSystem(enSubSystem)

        blnTDMode = objMachine.GetTDMode()

        If IsP300S() Then
            If blnTDMode Then
                objTools.SetToolAdjustment(intToolNo, enAxisIndex, enEdgeNo, enToolCuttingPosition, 0) 'clear value
                objTools.AddToolAdjustment(intToolNo, enAxisIndex, enEdgeNo, enToolCuttingPosition, dblValue) ' added to current value
                objTools.GetToolAdjustment(intToolNo, enAxisIndex, enEdgeNo, enToolCuttingPosition) ' get current value
            End If
        Else
            Throw New ApplicationException("Not supported in TD mode for P300S control")
        End If
    End Sub
#End Region

#Region "CTools.Get-Set-ToolOffset_P300S Example"
    ''' <summary>
    ''' Get/Set tool offset given registered tool number, axis index, edge number, cuttting position, and setting value
    ''' </summary>
    ''' <remarks>
    ''' <para>For P300S and IsLTMIMSpecOn = True and TD Mode = True, 
    ''' each registered tool number (Not a turret station number) 
    ''' can support tool offset per edge and cutting position if it is applicable. </para>
    ''' </remarks>
    Private Sub ToolOffset_P300S(intToolNo As Integer, _
                         enAxisIndex As Okuma.CLDATAPI.Enumerations.ToolOffsetAxisIndexEnum, _
                         enEdgeNo As Okuma.CLDATAPI.Enumerations.ToolEdgeEnum, _
                         enToolCuttingPosition As Okuma.CLDATAPI.Enumerations.ToolCuttingPositionEnum, _
                         dblValue As Double)

        Dim objSpec As Okuma.CLDATAPI.DataAPI.CSpec = New Okuma.CLDATAPI.DataAPI.CSpec
        Dim objTools As Okuma.CLDATAPI.DataAPI.CTools = New Okuma.CLDATAPI.DataAPI.CTools
        Dim objMachine As Okuma.CLDATAPI.DataAPI.CMachine = New Okuma.CLDATAPI.DataAPI.CMachine

        Dim blnTDMode As Boolean = False

        blnTDMode = objMachine.GetTDMode()

        If IsP300S() Then
            If blnTDMode Then
                objTools.SetToolOffset(intToolNo, enAxisIndex, enEdgeNo, enToolCuttingPosition, 0) 'clear value
                objTools.AddToolOffset(intToolNo, enAxisIndex, enEdgeNo, enToolCuttingPosition, dblValue) ' added to current value
                objTools.GetToolOffset(intToolNo, enAxisIndex, enEdgeNo, enToolCuttingPosition) ' get current value
            End If
        Else
            Throw New ApplicationException("Not supported in TD mode for P300S control")
        End If
    End Sub
#End Region

#Region "CTools.Get-Set-ToolOffset Example"
    ''' <summary>
    ''' Get/Set tool offset given offset number, axis index, and setting value
    ''' </summary>
    ''' <remarks>
    ''' </remarks>
    Private Sub ToolOffset(ByVal enSubSystem As Okuma.CLDATAPI.Enumerations.SubSystemEnum, intOffetIndex As Integer, _
                         enAxisIndex As Okuma.CLDATAPI.Enumerations.ToolOffsetAxisIndexEnum, _
                         dblValue As Double)
        Dim objTools As Okuma.CLDATAPI.DataAPI.CTools = New Okuma.CLDATAPI.DataAPI.CTools

        objTools.SetSubSystem(enSubSystem)

        objTools.SetToolOffset(intOffetIndex, enAxisIndex, 0) 'clear value
        objTools.AddToolOffset(intOffetIndex, enAxisIndex, dblValue) ' added to current value
        objTools.GetToolOffset(intOffetIndex, enAxisIndex) ' get current value

    End Sub
#End Region

#Region "CTools.Get-Set-NoseRComp Example"
    ''' <summary>
    ''' Get/Set/Add Nose-R compensation given offset number, axis index, and setting value
    ''' </summary>
    ''' <remarks>
    ''' </remarks>
    Private Sub NoseRCompensation(ByVal enSubSystem As Okuma.CLDATAPI.Enumerations.SubSystemEnum, intOffetIndex As Integer, _
                         enAxisIndex As Okuma.CLDATAPI.Enumerations.NoseRCompensationAxisIndexEnum, _
                         dblValue As Double)
        Dim objTools As Okuma.CLDATAPI.DataAPI.CTools = New Okuma.CLDATAPI.DataAPI.CTools

        objTools.SetSubSystem(enSubSystem)

        objTools.SetNoseRCompensation(intOffetIndex, enAxisIndex, 0) 'clear value
        objTools.AddNoseRCompensation(intOffetIndex, enAxisIndex, dblValue) ' added to current value
        objTools.GetNoseRCompensation(intOffetIndex, enAxisIndex) ' get current value

    End Sub
#End Region

#Region "CTools.Get-Set-ToolWear Example"
    ''' <summary>
    ''' Get/Set/Add Nose-R compensation given offset number, axis index, and setting value
    ''' </summary>
    ''' <remarks>
    ''' </remarks>
    Private Sub ToolWear(ByVal enSubSystem As Okuma.CLDATAPI.Enumerations.SubSystemEnum, intOffetIndex As Integer, _
                         enAxisIndex As Okuma.CLDATAPI.Enumerations.ToolWearOffsetAxisIndexEnum, _
                         dblValue As Double)
        Dim objTools As Okuma.CLDATAPI.DataAPI.CTools = New Okuma.CLDATAPI.DataAPI.CTools

        objTools.SetSubSystem(enSubSystem)

        objTools.SetToolWearOffset(intOffetIndex, enAxisIndex, 0) 'clear value
        objTools.AddToolWearOffset(intOffetIndex, enAxisIndex, dblValue) ' added to current value
        objTools.GetToolWearOffset(intOffetIndex, enAxisIndex) ' get current value

    End Sub
#End Region

#Region "CTools.Get-Set-ToolOffsetMultiBase Example"
    ''' <summary>
    ''' Get/Set tool offset given offset index, axis index, cuttting position, and setting value
    ''' </summary>
    ''' <remarks>
    ''' </remarks>
    Private Sub ToolOffsetMultiBase(ByVal enSubSystem As Okuma.CLDATAPI.Enumerations.SubSystemEnum, intOffetIndex As Integer, _
                            enAxisIndex As Okuma.CLDATAPI.Enumerations.ToolOffsetAxisIndexEnum, _
                            enCuttingPosition As Okuma.CLDATAPI.Enumerations.CuttingPositionEnum, _
                         dblValue As Double)
        Dim objTools As Okuma.CLDATAPI.DataAPI.CTools = New Okuma.CLDATAPI.DataAPI.CTools

        objTools.SetSubSystem(enSubSystem)

        objTools.SetToolOffset(intOffetIndex, enAxisIndex, enCuttingPosition, 0) 'clear value
        objTools.AddToolOffset(intOffetIndex, enAxisIndex, enCuttingPosition, dblValue) ' added to current value
        dblValue = objTools.GetToolOffset(intOffetIndex, enAxisIndex, enCuttingPosition) ' get current value

    End Sub
#End Region

#Region "CTools.Get-Set-ToolLifeStatus Example"
    ''' <summary>
    ''' Get/Set tool Life given tool life condition, tool number, and edge number
    ''' </summary>
    ''' <remarks>
    ''' <para>For P300S and IsLTMIMSpecOn = True and TD Mode = True, each registered tool number (Not a turret station number) can support tool life status per edge if it is applicable. </para>
    ''' <para>For P300L with Multi-Tool spec (NC Spec Code 2 [24, 7] MLTL = OFF) and IsLTMIMSpecOn = True, each tool number (turret station number) can have its own tool life status.</para>
    ''' <para>For P300L with Multi-Tool spec (NC Spec Code 2 [24, 7] MLTL = ON) and and IsLTMIMSpecOn = True, each edge of each tool number (turret station number) can have its own tool life status.</para>
    ''' <para>For P300L/P300S and IsLTMIMSpecOn = false, it will be like P100II/P200</para>
    ''' <para>For P110II/P200, each tool number (turret station number) can have its own tool life status.</para>
    ''' </remarks>
    Private Sub ToolLifeStatus(ByVal enSubSystem As Okuma.CLDATAPI.Enumerations.SubSystemEnum, _
                                    ByVal intToolNo As Integer, ByVal enEdgeNo As Okuma.CLDATAPI.Enumerations.ToolEdgeEnum, _
                                    ByVal enSetValue As Okuma.CLDATAPI.Enumerations.ToolLifeStatusEnum)
        Dim objSpec As Okuma.CLDATAPI.DataAPI.CSpec = New Okuma.CLDATAPI.DataAPI.CSpec
        Dim objTools As Okuma.CLDATAPI.DataAPI.CTools = New Okuma.CLDATAPI.DataAPI.CTools
        Dim objMachine As Okuma.CLDATAPI.DataAPI.CMachine = New Okuma.CLDATAPI.DataAPI.CMachine

        Dim blnMultiToolSpec As Boolean = False
        Dim blnTDMode As Boolean = False
        Dim enValue As Okuma.CLDATAPI.Enumerations.ToolLifeStatusEnum

        objMachine.SetSubSystem(enSubSystem)
        objTools.SetSubSystem(enSubSystem)

        blnMultiToolSpec = objSpec.GetBSpecCode(24, 7)
        blnTDMode = objMachine.GetTDMode()

        If IsP300S() Then
            If blnTDMode Then
                objTools.SetLifeStatus(intToolNo, enEdgeNo, enSetValue) 'set Life status
                enValue = objTools.GetLifeStatus(intToolNo, enEdgeNo) 'get current Life status
            Else
                Throw New ApplicationException("Not supported in TD mode for P300S control")
            End If
        ElseIf IsP300L() Then
            If blnMultiToolSpec Then
                objTools.SetLifeStatus(intToolNo, enEdgeNo, enSetValue) 'set Life status
                enValue = objTools.GetLifeStatus(intToolNo, enEdgeNo) 'get current Life status
            Else
                'Tool Life function is the same as in P100II/P200 controls
                objTools.SetLifeStatus(intToolNo, enSetValue) 'set Life status
                enValue = objTools.GetLifeStatus(intToolNo) 'get current Life status
            End If
        Else
            'when P300S or P300L and objSpec.IsLTMIMSpecOn() = false then the 
            'Tool Life function is the same as in P100II/P200 controls
            objTools.SetLifeStatus(intToolNo, enSetValue) 'set Life status
            enValue = objTools.GetLifeStatus(intToolNo) 'get current Life status
        End If
    End Sub
#End Region

#Region "CTools.Get-Set-ToolGaugeStatus Example"
    ''' <summary>
    ''' Get/Set tool gauge given tool life condition, tool number, and edge number
    ''' </summary>
    ''' <para>For P300S and IsLTMIMSpecOn = True and TD Mode = True, each registered tool number (Not a turret station number) can support tool gauge per edge if it is applicable. </para>
    ''' <para>For P300L with Multi-Tool spec (NC Spec Code 2 [24, 7] MLTL = OFF) and IsLTMIMSpecOn = True, each tool number (turret station number) can have its own gauge status</para>
    ''' <para>For P300L with Multi-Tool spec (NC Spec Code 2 [24, 7] MLTL = ON) and and IsLTMIMSpecOn = True, each edge of each tool number (turret station number) can have its own gauge status</para>
    ''' <para>For P300L/P300S and IsLTMIMSpecOn = false, it will be like P100II/P200</para>
    ''' <para>For P110II/P200, each tool number (turret station number) can have its own gauge status</para>
    Private Sub ToolGaugeStatus(ByVal enSubSystem As Okuma.CLDATAPI.Enumerations.SubSystemEnum, _
                                    ByVal intToolNo As Integer, ByVal enEdgeNo As Okuma.CLDATAPI.Enumerations.ToolEdgeEnum, _
                                    ByVal enSetValue As Okuma.CLDATAPI.Enumerations.ToolGaugeStatusEnum)
        Dim objSpec As Okuma.CLDATAPI.DataAPI.CSpec = New Okuma.CLDATAPI.DataAPI.CSpec
        Dim objTools As Okuma.CLDATAPI.DataAPI.CTools = New Okuma.CLDATAPI.DataAPI.CTools
        Dim objMachine As Okuma.CLDATAPI.DataAPI.CMachine = New Okuma.CLDATAPI.DataAPI.CMachine

        Dim blnMultiToolSpec As Boolean = False
        Dim blnTDMode As Boolean = False
        Dim enValue As Okuma.CLDATAPI.Enumerations.ToolGaugeStatusEnum

        objMachine.SetSubSystem(enSubSystem)
        objTools.SetSubSystem(enSubSystem)

        blnMultiToolSpec = objSpec.GetBSpecCode(24, 7)
        blnTDMode = objMachine.GetTDMode()

        If IsP300S() Then
            If blnTDMode Then
                objTools.SetGaugeStatus(intToolNo, enEdgeNo, enSetValue) 'set gauge status
                enValue = objTools.GetGaugeStatus(intToolNo, enEdgeNo) 'get current gauge status
            Else
                Throw New ApplicationException("Not supported in TD mode for P300S control")
            End If
        ElseIf IsP300L() Then
            If blnMultiToolSpec Then
                objTools.SetGaugeStatus(intToolNo, enEdgeNo, enSetValue) 'set gauge status
                enValue = objTools.GetGaugeStatus(intToolNo, enEdgeNo) 'get current gauge status
            Else
                'Tool Life function is the same as in P100II/P200 controls
                objTools.SetGaugeStatus(intToolNo, enSetValue) 'set gauge status
                enValue = objTools.GetGaugeStatus(intToolNo) 'get current gauge status
            End If
        Else
            'When P300S or P300L and objSpec.IsLTMIMSpecOn() = false then the 
            'Tool Life function is the same as in P100II/P200 controls
            objTools.SetGaugeStatus(intToolNo, enSetValue) 'set gauge status
            enValue = objTools.GetGaugeStatus(intToolNo) 'get current gauge status
        End If
    End Sub
#End Region

#Region "CTools.ToolLife Example"
    ''' <summary>
    ''' Get/Set/Add tool life given tool life condition, tool number, and edge number
    ''' </summary>
    ''' <para>For P300S and IsLTMIMSpecOn = True and TD Mode = True, each registered tool number (Not a turret station number) can support tool life per edge if it is applicable. </para>
    ''' <para>For P300L with Multi-Tool spec (NC Spec Code 2 [24, 7] MLTL = OFF) and IsLTMIMSpecOn = True, each tool number (turret station number) can have its own tool life value.</para>
    ''' <para>For P300L with Multi-Tool spec (NC Spec Code 2 [24, 7] MLTL = ON) and and IsLTMIMSpecOn = True, each edge of each tool number (turret station number) can support tool life per edge.</para>
    ''' <para>For P300L/P300S and IsLTMIMSpecOn = false, it will be like P100II/P200</para>
    ''' <para>For P110II/P200, each tool number (turret station number) can have its own tool life value.</para>
    Private Sub ToolLife(ByVal enSubSystem As Okuma.CLDATAPI.Enumerations.SubSystemEnum, _
                                    ByVal enToolLifeCondition As Okuma.CLDATAPI.Enumerations.ToolLifeConditionEnum, _
                                    ByVal intToolNo As Integer, ByVal enEdgeNo As Okuma.CLDATAPI.Enumerations.ToolEdgeEnum, _
                                    ByVal dblActualValue As Double, ByVal dblSetValue As Double)
        Dim objSpec As Okuma.CLDATAPI.DataAPI.CSpec = New Okuma.CLDATAPI.DataAPI.CSpec
        Dim objTools As Okuma.CLDATAPI.DataAPI.CTools = New Okuma.CLDATAPI.DataAPI.CTools
        Dim objMachine As Okuma.CLDATAPI.DataAPI.CMachine = New Okuma.CLDATAPI.DataAPI.CMachine

        Dim blnMultiToolSpec As Boolean = False
        Dim blnTDMode As Boolean = False
        Dim dblValue As Double = 0.0

        objMachine.SetSubSystem(enSubSystem)
        objTools.SetSubSystem(enSubSystem)

        blnMultiToolSpec = objSpec.GetBSpecCode(24, 7)
        blnTDMode = objMachine.GetTDMode()

        If IsP300S() Then
            If blnTDMode Then
                objTools.SetToolLife(enToolLifeCondition, intToolNo, enEdgeNo, dblSetValue) 'set tool life
                objTools.SetActualToolLife(enToolLifeCondition, intToolNo, enEdgeNo, 0) 'clear actual tool life
                objTools.AddActualToolLife(enToolLifeCondition, intToolNo, enEdgeNo, dblActualValue) 'add new value from the current value
                dblValue = objTools.GetActualToolLife(enToolLifeCondition, intToolNo, enEdgeNo) 'get current value
            Else
                Throw New ApplicationException("Not supported in TD mode for P300S control")
            End If
        ElseIf IsP300L() Then
            If blnMultiToolSpec Then
                objTools.SetToolLife(enToolLifeCondition, intToolNo, enEdgeNo, dblSetValue) 'set tool life
                objTools.SetActualToolLife(enToolLifeCondition, intToolNo, enEdgeNo, 0) 'clear actual tool life
                objTools.AddActualToolLife(enToolLifeCondition, intToolNo, enEdgeNo, dblActualValue) 'add new value from the current value
                dblValue = objTools.GetActualToolLife(enToolLifeCondition, intToolNo, enEdgeNo) 'get current value
            Else
                'Tool Life function is the same as in P100II/P200 controls
                objTools.SetToolLife(enToolLifeCondition, intToolNo, dblSetValue) 'set tool life
                objTools.SetActualToolLife(enToolLifeCondition, intToolNo, 0)   'clear actual tool life
                objTools.AddActualToolLife(enToolLifeCondition, intToolNo, dblActualValue) 'add new value from the current value
                dblValue = objTools.GetActualToolLife(enToolLifeCondition, intToolNo) ' get current actual value
            End If
        Else
            'When P300S or P300L and objSpec.IsLTMIMSpecOn() = false then the
            'Tool Life function is the same as in P100II/P200 controls
            objTools.SetToolLife(enToolLifeCondition, intToolNo, dblSetValue) 'set tool life
            objTools.SetActualToolLife(enToolLifeCondition, intToolNo, 0)   'clear actual tool life
            objTools.AddActualToolLife(enToolLifeCondition, intToolNo, dblActualValue) 'add new value from the current value
            dblValue = objTools.GetActualToolLife(enToolLifeCondition, intToolNo) ' get current value
        End If
    End Sub

#End Region

#Region "CTools.ToolGroup Example"
    ''' <summary>
    ''' Get/Set/Add tool group given tool life condition, tool number, and edge number
    ''' </summary>
    ''' <para>For P300S and IsLTMIMSpecOn = True and TD Mode = True, each registered tool number (Not a turret station number) can support tool life per edge if it is applicable. </para>
    ''' <para>For P300L with Multi-Tool spec (NC Spec Code 2 [24, 7] MLTL = OFF) and IsLTMIMSpecOn = True, each tool number (turret station number) can have its own tool life value.</para>
    ''' <para>For P300L with Multi-Tool spec (NC Spec Code 2 [24, 7] MLTL = ON) and and IsLTMIMSpecOn = True, each edge of each tool number (turret station number) can support tool life per edge.</para>
    ''' <para>For P300L/P300S and IsLTMIMSpecOn = false, it will be like P100II/P200</para>
    ''' <para>For P110II/P200, each tool number (turret station number) can have its own tool life value.</para>
    Private Sub ToolGroup(ByVal enSubSystem As Okuma.CLDATAPI.Enumerations.SubSystemEnum, _
                                    ByVal intToolNo As Integer, ByVal enEdgeNo As Okuma.CLDATAPI.Enumerations.ToolEdgeEnum, _
                                    ByVal intGroupNo As Integer)
        Dim objSpec As Okuma.CLDATAPI.DataAPI.CSpec = New Okuma.CLDATAPI.DataAPI.CSpec
        Dim objTools As Okuma.CLDATAPI.DataAPI.CTools = New Okuma.CLDATAPI.DataAPI.CTools
        Dim objMachine As Okuma.CLDATAPI.DataAPI.CMachine = New Okuma.CLDATAPI.DataAPI.CMachine

        Dim blnMultiToolSpec As Boolean = False
        Dim blnTDMode As Boolean = False

        objMachine.SetSubSystem(enSubSystem)
        objTools.SetSubSystem(enSubSystem)

        blnMultiToolSpec = objSpec.GetBSpecCode(24, 7)
        blnTDMode = objMachine.GetTDMode()


        If (objSpec.GetControlType() = Okuma.CLDATAPI.Enumerations.ControlTypeEnum.P300SLP) And objSpec.IsLTMIMSpecOn() And blnTDMode Then
            objTools.SetGroupNo(intToolNo, enEdgeNo, intGroupNo) 'set value 
            objTools.GetGroupNo(intToolNo, enEdgeNo) 'get value 
        ElseIf IsP300L() Then
            If blnMultiToolSpec Then
                objTools.SetGroupNo(intToolNo, enEdgeNo, intGroupNo) 'set value 
                objTools.GetGroupNo(intToolNo, enEdgeNo) 'get value 
            Else
                'Tool Life function is the same as in P100II/P200 controls
                objTools.SetGroupNo(intToolNo, intGroupNo) 'set value 
                objTools.GetGroupNo(intToolNo) 'get value 
            End If
        Else
            'When P300S or P300L and objSpec.IsLTMIMSpecOn() = false then the 
            'Tool Life function is the same as in P100II/P200 controls
            objTools.SetGroupNo(intToolNo, intGroupNo) 'set value 
            objTools.GetGroupNo(intToolNo) 'get value 
        End If
    End Sub

#End Region

#Region "CTools.ReferenceToolOffset Example"
    ''' <summary>
    ''' This sample is using the following functions from Okuma.CLDATAPI.DataAPI.CTools class to 
    ''' set the Reference Tool Offset 1/2/3 if applicable for each control type given Tool Number, Tool Edge Number, Spindle Axis Mode, and Offset Index number.
    ''' </summary>
    ''' <remarks>
    ''' <para>For P300S and IsLTMIMSpecOn = True and TD Mode = True, each tool number (Not a turret station number) can support 3 reference offset numbers named as OG1/2/3</para>
    ''' <para>For P300L with Multi-Tool spec (NC Spec Code 2 [24, 7] MLTL = OFF) and IsLTMIMSpecOn = True, each tool number (turret station number) can only support 2 reference offset numbers named as OFFSET NO.1 AND OFFSET NO.2</para>
    ''' <para>For P300L with Multi-Tool spec (NC Spec Code 2 [24, 7] MLTL = ON) and and IsLTMIMSpecOn = True, each edge of each tool number (turret station number) can support 3 reference offset numbers named as OG1/2/3</para>
    ''' <para>For P300L/P300S and IsLTMIMSpecOn = false, it will be like P100II/P200</para>
    ''' <para>For P110II/P200, each tool number (turret station number) can support 3 reference offset numbers named as OG1/2/3</para>
    ''' </remarks>
    Private Sub ReferenceToolOffset_123(ByVal enSubSystem As Okuma.CLDATAPI.Enumerations.SubSystemEnum, _
                                        ByVal intToolNo As Integer, _
                                         ByVal enToolEdge As Okuma.CLDATAPI.Enumerations.ToolEdgeEnum, _
                                         ByVal intOffsetIndex As Integer)
        Dim blnTDMode As Boolean = False
        Dim blnMultiToolLifeSpec As Boolean = False
        Dim blnDualSidesLathe As Boolean
        Dim blnBAxisControlSpec As Boolean = False

        Dim objSpec As Okuma.CLDATAPI.DataAPI.CSpec = New Okuma.CLDATAPI.DataAPI.CSpec
        Dim objTools As Okuma.CLDATAPI.DataAPI.CTools = New Okuma.CLDATAPI.DataAPI.CTools
        Dim objTurret As Okuma.CLDATAPI.DataAPI.CTurret = New Okuma.CLDATAPI.DataAPI.CTurret

        objTurret.SetSubSystem(enSubSystem)
        objTools.SetSubSystem(enSubSystem)

        blnMultiToolLifeSpec = objSpec.GetBSpecCode(24, 7) And objSpec.GetSpecCode(21, 3)
        blnDualSidesLathe = objSpec.IsValidSystem(Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_2AL)
        blnBAxisControlSpec = objSpec.GetSpecCode(8, 7)


        blnTDMode = IsTDMode()

        If objTools.IsLTMIMSpecOn Then
            If (objSpec.GetControlType() = Okuma.CLDATAPI.Enumerations.ControlTypeEnum.P300SLP) Then
                If blnTDMode Then
                    'Get/Set reference tool offset 1,2,3 that is associated with a tool number, edge number
                    objTools.SetReferenceToolOffset1(intToolNo, enToolEdge, intOffsetIndex)
                    intOffsetIndex = objTools.GetReferenceToolOffset1(intToolNo, enToolEdge)

                    objTools.SetReferenceToolOffset2(intToolNo, enToolEdge, intOffsetIndex)
                    intOffsetIndex = objTools.GetReferenceToolOffset2(intToolNo, enToolEdge)

                    objTools.SetReferenceToolOffset3(intToolNo, enToolEdge, intOffsetIndex)
                    intOffsetIndex = objTools.GetReferenceToolOffset2(intToolNo, enToolEdge)
                Else
                    Throw New ApplicationException("Not supported in TD mode for P300S control")
                End If

            ElseIf (objSpec.GetControlType() = Okuma.CLDATAPI.Enumerations.ControlTypeEnum.P300L) Then

                If blnMultiToolLifeSpec = False Then
                    'Get/Set reference tool offset 1,2,3 that is associated with a tool/station number
                    objTools.SetReferenceToolOffset1(intToolNo, intOffsetIndex)
                    intOffsetIndex = objTools.GetReferenceToolOffset1(intToolNo)

                    objTools.SetReferenceToolOffset2(intToolNo, intOffsetIndex)
                    intOffsetIndex = objTools.GetReferenceToolOffset2(intToolNo)

                    objTools.SetReferenceToolOffset3(intToolNo, intOffsetIndex)
                    intOffsetIndex = objTools.GetReferenceToolOffset3(intToolNo)

                Else
                    'Get/Set reference tool offset 1,2,3 that is associated with a tool number, edge number
                    objTools.SetReferenceToolOffset1(intToolNo, enToolEdge, intOffsetIndex)
                    intOffsetIndex = objTools.GetReferenceToolOffset1(intToolNo, enToolEdge)

                    objTools.SetReferenceToolOffset2(intToolNo, enToolEdge, intOffsetIndex)
                    intOffsetIndex = objTools.GetReferenceToolOffset2(intToolNo, enToolEdge)

                    objTools.SetReferenceToolOffset3(intToolNo, enToolEdge, intOffsetIndex)
                    intOffsetIndex = objTools.GetReferenceToolOffset3(intToolNo, enToolEdge)

                End If
            End If

        Else    'For control type = P300S/P300L and objSpec.IsLTMIMSpecOn() = false or P100II/P200

            'For standard lathe (single side machine), tool life is per turret station of each turret A/B/C on single side machine
            'For 2 sides lathe, tool life is per turret station of each side of machine. 
            'A Turret on R side machine is R_Side_Turret. A Turret on L side machine is L_Side_Turret.

            'Get/Set reference tool offset 1,2,3 that is associated with a tool number only (turret station number)
            objTools.SetReferenceToolOffset1(intToolNo, intOffsetIndex)
            intOffsetIndex = objTools.GetReferenceToolOffset1(intToolNo)

            objTools.SetReferenceToolOffset2(intToolNo, intOffsetIndex)
            intOffsetIndex = objTools.GetReferenceToolOffset2(intToolNo)

            objTools.SetReferenceToolOffset3(intToolNo, intOffsetIndex)
            intOffsetIndex = objTools.GetReferenceToolOffset3(intToolNo)


        End If

    End Sub

    ''' <summary>
    ''' Get/Set ReferenceToolOffset 1/2/3 when B Axis control is ON
    ''' </summary>
    ''' <param name="enSubSystem"></param>
    ''' <param name="enPrincipalAxisIndex"></param>
    ''' <param name="enBAxisCuttingPosition"></param>
    ''' <param name="intToolNo"></param>
    ''' <param name="intValue"></param>
    ''' <remarks>Sample codes only. It does not detect all specifications of each machine</remarks>
    Private Sub ReferenceToolOffset_123(ByVal enSubSystem As Okuma.CLDATAPI.Enumerations.SubSystemEnum, _
                        ByVal enPrincipalAxisIndex As Okuma.CLDATAPI.Enumerations.PrincipalAxisEnum, _
                        ByVal enBAxisCuttingPosition As Okuma.CLDATAPI.Enumerations.BAxisCuttingPositionEnum, _
                        ByVal intToolNo As Integer, _
                        ByVal intValue As Integer)

        Dim objSpec As Okuma.CLDATAPI.DataAPI.CSpec = New Okuma.CLDATAPI.DataAPI.CSpec
        Dim objTools As Okuma.CLDATAPI.DataAPI.CTools = New Okuma.CLDATAPI.DataAPI.CTools
        Dim objTurret As Okuma.CLDATAPI.DataAPI.CTurret = New Okuma.CLDATAPI.DataAPI.CTurret

        objTurret.SetSubSystem(enSubSystem)
        objTools.SetSubSystem(enSubSystem)

        objTools.SetReferenceToolOffset1(enPrincipalAxisIndex, enBAxisCuttingPosition, intToolNo, intValue)
        intValue = objTools.GetReferenceToolOffset1(enPrincipalAxisIndex, enBAxisCuttingPosition, intToolNo)

        objTools.SetReferenceToolOffset2(enPrincipalAxisIndex, enBAxisCuttingPosition, intToolNo, intValue)
        intValue = objTools.GetReferenceToolOffset2(enPrincipalAxisIndex, enBAxisCuttingPosition, intToolNo)

        objTools.SetReferenceToolOffset3(enPrincipalAxisIndex, enBAxisCuttingPosition, intToolNo, intValue)
        intValue = objTools.GetReferenceToolOffset3(enPrincipalAxisIndex, enBAxisCuttingPosition, intToolNo)
    End Sub


#Region "CTools.ReferenceToolOffset_12 Example"
    ''' <summary>
    ''' This sample is using the following functions from Okuma.CLDATAPI.DataAPI.CTools class to 
    ''' set the Reference Tool Offset 1/2 if applicable for each control type given Tool Number, Tool Edge Number, Spindle Axis Mode, and Offset Index number.
    ''' GetToolList, GetRegisteredToolEdges, GetRegisteredCuttingPositions, GetSpindleAxisMode, and SetReferenceToolOffset
    ''' </summary>
    ''' <remarks>
    ''' <para>For P300L with Multi-Tool spec (NC Spec Code 2 [24, 7] MLTL = OFF) and IsLTMIMSpecOn = True, 
    ''' each tool number (turret station number) can only support 2 reference offset numbers named as OFFSET NO.1 AND OFFSET NO.2</para>
    ''' </remarks>
    Private Sub ReferenceToolOffset_12(ByVal enSubSystem As Okuma.CLDATAPI.Enumerations.SubSystemEnum, _
                                        ByVal intToolNo As Integer, _
                                         ByVal enToolEdge As Okuma.CLDATAPI.Enumerations.ToolEdgeEnum, _
                                         ByVal enToolCuttingPosition As Okuma.CLDATAPI.Enumerations.ToolCuttingPositionEnum, _
                                         ByVal intOffsetIndex As Integer)
        Dim enSpindleAxisMode As Okuma.CLDATAPI.Enumerations.SpindleAxisModeEnum
        Dim objTools As Okuma.CLDATAPI.DataAPI.CTools = New Okuma.CLDATAPI.DataAPI.CTools

        objTools.SetSubSystem(enSubSystem)

        If IsP300L() Then

            enSpindleAxisMode = SpindleAxisMode(enSubSystem, intToolNo, enToolEdge, enToolCuttingPosition)

            'Get/Set reference tool offset 1,2 that is associated with a tool number, edge number, and spindle axis mode.
            objTools.SetReferenceToolOffset1(intToolNo, enToolEdge, enSpindleAxisMode, intOffsetIndex)
            intOffsetIndex = objTools.GetReferenceToolOffset1(intToolNo, enToolEdge, enSpindleAxisMode)

            objTools.SetReferenceToolOffset2(intToolNo, enToolEdge, enSpindleAxisMode, intOffsetIndex)
            intOffsetIndex = objTools.GetReferenceToolOffset2(intToolNo, enToolEdge, enSpindleAxisMode)
        Else
            Throw New ApplicationException("Not supported on other control types")
        End If

    End Sub

#End Region

#End Region

#Region "CTools.ToolPositionComment Example"
    ''' <summary>
    ''' Get tool position comment given tool number, edge number, and cutting position for current subsystem
    ''' </summary>
    ''' <para>For P300S and IsLTMIMSpecOn = True</para>
    Private Sub ToolPositionComment(ByVal enSubSystem As Okuma.CLDATAPI.Enumerations.SubSystemEnum, _
                                    ByVal intToolNo As Integer, ByVal enEdgeNo As Okuma.CLDATAPI.Enumerations.ToolEdgeEnum, _
                                    ByVal enToolCuttingPosition As Okuma.CLDATAPI.Enumerations.ToolCuttingPositionEnum)
        Dim objSpec As Okuma.CLDATAPI.DataAPI.CSpec = New Okuma.CLDATAPI.DataAPI.CSpec
        Dim objTools As Okuma.CLDATAPI.DataAPI.CTools = New Okuma.CLDATAPI.DataAPI.CTools
        Dim objMachine As Okuma.CLDATAPI.DataAPI.CMachine = New Okuma.CLDATAPI.DataAPI.CMachine
        Dim strValue As String = ""

        objMachine.SetSubSystem(enSubSystem)
        objTools.SetSubSystem(enSubSystem)

        If (objSpec.GetControlType() = Okuma.CLDATAPI.Enumerations.ControlTypeEnum.P300SLP) And objSpec.IsLTMIMSpecOn() Then
            strValue = objTools.GetToolPositionComment(intToolNo, enEdgeNo, enToolCuttingPosition)
        End If

    End Sub

#End Region

#Region "CTools.GetSpindleAxisMode Example"
    ''' <summary>
    ''' Get spindle axis mode given tool number, edge number, and cutting position for current subsystem
    ''' </summary>
    Private Function SpindleAxisMode(ByVal enSubSystem As Okuma.CLDATAPI.Enumerations.SubSystemEnum, _
                                    ByVal intToolNo As Integer, ByVal enEdgeNo As Okuma.CLDATAPI.Enumerations.ToolEdgeEnum, _
                                    ByVal enToolCuttingPosition As Okuma.CLDATAPI.Enumerations.ToolCuttingPositionEnum)
        Dim objSpec As Okuma.CLDATAPI.DataAPI.CSpec = New Okuma.CLDATAPI.DataAPI.CSpec
        Dim objTools As Okuma.CLDATAPI.DataAPI.CTools = New Okuma.CLDATAPI.DataAPI.CTools
        Dim objMachine As Okuma.CLDATAPI.DataAPI.CMachine = New Okuma.CLDATAPI.DataAPI.CMachine
        Dim enValue As Okuma.CLDATAPI.Enumerations.SpindleAxisModeEnum = Okuma.CLDATAPI.Enumerations.SpindleAxisModeEnum.None

        objMachine.SetSubSystem(enSubSystem)
        objTools.SetSubSystem(enSubSystem)

        If (objSpec.GetControlType() = Okuma.CLDATAPI.Enumerations.ControlTypeEnum.P300SLP Or objSpec.GetControlType() = Okuma.CLDATAPI.Enumerations.ControlTypeEnum.P300L) And objSpec.IsLTMIMSpecOn() Then
            enValue = objTools.GetSpindleAxisMode(intToolNo, enEdgeNo, enToolCuttingPosition)
        End If

        Return enValue
    End Function

#End Region

#Region "Helper Functions"

    ''' <summary>
    ''' Get PLC spec code give PLC spec code index and bit
    ''' </summary>
    ''' <param name="intIndex"></param>
    ''' <param name="intBit"></param>
    ''' <returns>True if it is ON. Otherwise, it returns false</returns>
    ''' <remarks></remarks>
    Public Function IsPLCSpecCodeTurnOn(ByVal intIndex As Integer, ByVal intBit As Integer) As Boolean
        Dim objSpec As Okuma.CLDATAPI.DataAPI.CSpec
        objSpec = New Okuma.CLDATAPI.DataAPI.CSpec
        Return objSpec.GetPLCSpecCode(intIndex, intBit)
    End Function

    ''' <summary>
    ''' Get PLC 2 spec code give PLC spec code index and bit
    ''' </summary>
    ''' <param name="intIndex"></param>
    ''' <param name="intBit"></param>
    ''' <returns>True if it is ON. Otherwise, it returns false</returns>
    ''' <remarks></remarks>
    Public Function IsPLC2SpecCodeTurnOn(ByVal intIndex As Integer, ByVal intBit As Integer) As Boolean
        Dim objSpec As Okuma.CLDATAPI.DataAPI.CSpec
        objSpec = New Okuma.CLDATAPI.DataAPI.CSpec
        Return objSpec.GetPLCSpecCode2(intIndex, intBit)
    End Function

    ''' <summary>
    ''' Get PLC 3 spec code give PLC spec code index and bit
    ''' </summary>
    ''' <param name="intIndex"></param>
    ''' <param name="intBit"></param>
    ''' <returns>True if it is ON. Otherwise, it returns false</returns>
    ''' <remarks></remarks>
    Public Function IsPLC3SpecCodeTurnOn(ByVal intIndex As Integer, ByVal intBit As Integer) As Boolean
        Dim objSpec As Okuma.CLDATAPI.DataAPI.CSpec
        objSpec = New Okuma.CLDATAPI.DataAPI.CSpec
        Return objSpec.GetPLCSpecCode3(intIndex, intBit)
    End Function

    ''' <summary>
    ''' Check if a sub system is valid on the machine
    ''' </summary>
    ''' <param name="enSubSystem"></param>
    ''' <returns>True if it is valid. </returns>
    ''' <remarks>This checking is at sub system level only. 
    ''' For example: 
    ''' NC_AL is valid but it does not mean that the machine can support Y-axis 
    ''' as it is an option on the machine.
    ''' </remarks>
    Private Function IsValidSubSystem(ByVal enSubSystem As Okuma.CLDATAPI.Enumerations.SubSystemEnum) As Boolean
        Dim objSpec As Okuma.CLDATAPI.DataAPI.CSpec
        objSpec = New Okuma.CLDATAPI.DataAPI.CSpec
        Return objSpec.IsValidSystem(enSubSystem)
    End Function

    ''' <summary>
    ''' Check if C turret can be supported on this machine 
    ''' </summary>
    ''' <returns>True if it can be supported. Otherwise, it returns false</returns>
    ''' <remarks>A Turret is always available on standard Lathe for P100II/P200L/P300L or newer controls. On 2 sides machine spec, it only has A turret on each side of machine.</remarks>
    Private Function IsCTurretSpecCodeOn() As Boolean
        Dim objSpec As Okuma.CLDATAPI.DataAPI.CSpec
        objSpec = New Okuma.CLDATAPI.DataAPI.CSpec
        Return objSpec.GetBSpecCode(21, 4)
    End Function

    ''' <summary>
    ''' Check if B turret can be supported on this machine 
    ''' </summary>
    ''' <returns>True if it can be supported. Otherwise, it returns false</returns>
    ''' <remarks>A Turret is always available on standard Lathe for P100II/P200L/P300L or newer controls. On 2 sides machine spec, it only has A turret on each side of machine.</remarks>
    Private Function IsBTurretSpecCodeOn() As Boolean
        Dim objSpec As Okuma.CLDATAPI.DataAPI.CSpec
        objSpec = New Okuma.CLDATAPI.DataAPI.CSpec
        Return objSpec.Get2SaddleSpec()
    End Function

    ''' <summary>
    ''' Get NC spec code given spec code index and bit location displayed on NC-HMI
    ''' </summary>
    ''' <param name="intSpecCodeIndex"></param>
    ''' <param name="intBit"></param>
    ''' <returns>True if spec code is ON</returns>
    ''' <remarks></remarks>
    Public Function GetSpecCode(ByVal intSpecCodeIndex As Integer, ByVal intBit As Integer) As Boolean
        Dim objSpec As Okuma.CLDATAPI.DataAPI.CSpec = New Okuma.CLDATAPI.DataAPI.CSpec
        Return objSpec.GetSpecCode(intSpecCodeIndex, intBit)
    End Function

    ''' <summary>
    ''' Get NC spec code 2 given spec code index and bit location displayed on NC-HMI
    ''' </summary>
    ''' <param name="intSpecCodeIndex"></param>
    ''' <param name="intBit"></param>
    ''' <returns>True if spec code is ON</returns>
    ''' <remarks></remarks>
    Public Function GetBSpecCode(ByVal intSpecCodeIndex As Integer, ByVal intBit As Integer) As Boolean
        Dim objSpec As Okuma.CLDATAPI.DataAPI.CSpec = New Okuma.CLDATAPI.DataAPI.CSpec
        Return objSpec.GetBSpecCode(intSpecCodeIndex, intBit)
    End Function

    ''' <summary>
    ''' If one spindle spec then first spindle is selected by default
    ''' if 2 spindles spec then if second spindle is not selected then first one is selected
    ''' </summary>
    ''' <returns>True if first one is selected</returns>
    ''' <remarks></remarks>
    Public Function IsFirstSpindleSelected() As Boolean
        Dim objSpindle As New Okuma.CLDATAPI.DataAPI.CSpindle
        If objSpindle.GetCurrentSpindleSelection = Okuma.CLDATAPI.Enumerations.SpindleSelectionEnum.LeftSpindle Then
            Return True
        Else
            Return False
        End If
    End Function

    ''' <summary>
    ''' Check if second spindle is selected on 2 spindles spec.  
    ''' </summary>
    ''' <returns>True if second one is selected on 2 spindles spec.  Return false if one spindle spec</returns>
    ''' <remarks>On single spindle spec it always returns false</remarks>
    Public Function IsSecondSpindleSelected() As Boolean
        Dim objSpindle As New Okuma.CLDATAPI.DataAPI.CSpindle
        If objSpindle.GetCurrentSpindleSelection = Okuma.CLDATAPI.Enumerations.SpindleSelectionEnum.RightSpindle Then
            Return True
        Else
            Return False
        End If
    End Function
    ''' -----------------------------------------------------------------------------
    ''' <summary>
    ''' check if A turret is selected from control panel
    ''' </summary>
    ''' <returns></returns>
    ''' <remarks>
    ''' when two turret is available, IO output index 512, bit 6 is indicator of 
    ''' A turret selected, bit 7 is for B turret
    ''' when no turret or only one turret is available, both bits are off
    ''' One the turrets must be selected on the control in case of more than one turret
    ''' If there is only one A is selected by default
    ''' </remarks>
    ''' -----------------------------------------------------------------------------
    Protected Function IsATurretSeletected() As Boolean
        Dim objCTurret As Okuma.CLDATAPI.DataAPI.CTurret
        objCTurret = New Okuma.CLDATAPI.DataAPI.CTurret
        If objCTurret.GetTurretMode() = Okuma.CLDATAPI.Enumerations.TurretModeEnum.A_Turret Then
            Return True
        Else
            Return False
        End If
    End Function

    ''' -----------------------------------------------------------------------------
    ''' <summary>
    ''' check if B turret is selected from control panel
    ''' </summary>
    ''' <returns></returns>
    ''' <remarks>
    ''' </remarks>
    ''' -----------------------------------------------------------------------------
    Protected Function IsBTurretSeletected() As Boolean
        Dim objCTurret As Okuma.CLDATAPI.DataAPI.CTurret
        objCTurret = New Okuma.CLDATAPI.DataAPI.CTurret
        If objCTurret.GetTurretMode() = Okuma.CLDATAPI.Enumerations.TurretModeEnum.B_Turret Then
            Return True
        Else
            Return False
        End If
    End Function

    ''' -----------------------------------------------------------------------------
    ''' <summary>
    ''' check if C turret is selected from control panel
    ''' </summary>
    ''' <returns></returns>
    ''' <remarks>
    ''' </remarks>
    ''' -----------------------------------------------------------------------------
    Protected Function IsCTurretSeletected() As Boolean
        Dim objCTurret As Okuma.CLDATAPI.DataAPI.CTurret
        objCTurret = New Okuma.CLDATAPI.DataAPI.CTurret
        If objCTurret.GetTurretMode() = Okuma.CLDATAPI.Enumerations.TurretModeEnum.C_Turret Then
            Return True
        Else
            Return False
        End If
    End Function

    ''' <summary>
    ''' Check function spec and sub system notes per method type
    ''' </summary>
    ''' <param name="enMethodType">method type</param>
    ''' <param name="intAxisIndex">Axis index if applicable to function</param>
    ''' <param name="enCuttingPosition">Cutting position if applicable to function</param>
    ''' <param name="enSubSystem">Sub System if applicable to function</param>
    ''' <returns>True if the method type can be supported for current machine conditions.</returns>
    ''' <remarks>Sample codes only. It does not detect all specification of each machine</remarks>
    Private Function CheckMethodSpec(ByVal enMethodType As MethodTypeEnum, _
                                       Optional intToolNo As Integer = -1, Optional intAxisIndex As Integer = -1, _
                                       Optional ByVal enCuttingPosition As Okuma.CLDATAPI.Enumerations.CuttingPositionEnum = Okuma.CLDATAPI.Enumerations.CuttingPositionEnum.PrincipalAxis1_BaseA, _
                                       Optional ByVal enBAxisCuttingPosition As Okuma.CLDATAPI.Enumerations.BAxisCuttingPositionEnum = Okuma.CLDATAPI.Enumerations.BAxisCuttingPositionEnum.BasePosition, _
                                       Optional ByVal enPrincipalAxis As Okuma.CLDATAPI.Enumerations.PrincipalAxisEnum = Okuma.CLDATAPI.Enumerations.PrincipalAxisEnum.SpindleAxis_1, _
                                       Optional ByVal enSubSystem As Okuma.CLDATAPI.Enumerations.SubSystemEnum = Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_AL)
        Dim blnReturn As Boolean = False

        If IsValidSubSystem(enSubSystem) = False Then Return False

        Select Case enMethodType
            Case MethodTypeEnum.ReferenceToolOffset_123_BAxisControl

                If GetSpecCode(21, 3) And GetSpecCode(8, 7) Then ' TLFC and BAX
                    If enBAxisCuttingPosition = Okuma.CLDATAPI.Enumerations.BAxisCuttingPositionEnum.VerticalPosition And enPrincipalAxis = Okuma.CLDATAPI.Enumerations.PrincipalAxisEnum.SpindleAxis_1 Then
                        blnReturn = Not GetSpecCode(21, 6)
                    ElseIf enBAxisCuttingPosition = Okuma.CLDATAPI.Enumerations.BAxisCuttingPositionEnum.BasePosition And enPrincipalAxis = Okuma.CLDATAPI.Enumerations.PrincipalAxisEnum.SpindleAxis_2 Then
                        blnReturn = Not GetSpecCode(21, 6) And GetSpecCode(4, 1)
                    ElseIf enBAxisCuttingPosition = Okuma.CLDATAPI.Enumerations.BAxisCuttingPositionEnum.VerticalPosition And enPrincipalAxis = Okuma.CLDATAPI.Enumerations.PrincipalAxisEnum.SpindleAxis_2 Then
                        blnReturn = Not GetSpecCode(21, 6) And GetSpecCode(4, 1)
                    Else
                        blnReturn = True
                    End If

                    If blnReturn Then
                        Select Case enSubSystem
                            Case Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_RUN, Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_PANEL
                                blnReturn = CheckSubSystemNote(5, enSubSystem:=enSubSystem)

                            Case Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_RUN_1, _
                                Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_PANEL_1, _
                                Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_AL, Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_AR

                                blnReturn = True
                            Case Else
                                blnReturn = False
                        End Select
                    End If
                End If

            Case MethodTypeEnum.ToolGroup_P300S, MethodTypeEnum.ToolPositionComment_P300S
                blnReturn = CheckSubSystemNote(39, enSubSystem:=enSubSystem)

            Case MethodTypeEnum.ToolGaugeStatus_P300S, _
                MethodTypeEnum.ToolLife_P300S, _
                MethodTypeEnum.ToolLifeStatus_P300S, _
                MethodTypeEnum.ReferenceToolOffset_123_P300S

                blnReturn = CheckSubSystemNote(42, enSubSystem:=enSubSystem)

            Case MethodTypeEnum.ReferenceToolOffset_12

                blnReturn = CheckSubSystemNote(45, enSubSystem:=enSubSystem)

            Case MethodTypeEnum.ReferenceToolOffset_123
                If GetSpecCode(21, 3) Then ' TLFC
                    Select Case enSubSystem
                        Case Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_RUN, Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_PANEL
                            blnReturn = CheckSubSystemNote(21, intToolNo:=intToolNo, enSubSystem:=enSubSystem)

                        Case Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_RUN_1, _
                            Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_PANEL_1, _
                            Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_AL, Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_AR, _
                            Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_2AL

                            blnReturn = CheckSubSystemNote(22, enSubSystem:=enSubSystem)

                        Case Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_RUN_2, _
                            Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_RUN_3, _
                            Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_PANEL_2, _
                            Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_PANEL_3, _
                            Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_BL, Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_BR, _
                            Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_CL, Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_CR

                            blnReturn = CheckSubSystemNote(16, intToolNo, enSubSystem:=enSubSystem)

                        Case Else
                            blnReturn = True
                    End Select
                End If
            Case MethodTypeEnum.ReferenceToolOffsetMultiTool_123
                If GetSpecCode(21, 3) And Not GetSpecCode(8, 7) Then ' TLFC and BAX
                    blnReturn = CheckSubSystemNote(16, intToolNo, enSubSystem:=enSubSystem) And CheckSubSystemNote(45)
                End If
            Case MethodTypeEnum.ToolLife, MethodTypeEnum.ToolLifeStatus, MethodTypeEnum.ToolGaugeStatus, MethodTypeEnum.ToolGroup
                If GetSpecCode(21, 3) Then
                    Select Case enSubSystem
                        Case Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_RUN, Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_PANEL
                            blnReturn = CheckSubSystemNote(15, intToolNo, enSubSystem:=enSubSystem)
                        Case Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_RUN_2, _
                            Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_RUN_3, _
                            Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_PANEL_2, _
                            Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_PANEL_3, _
                            Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_BL, Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_BR, _
                            Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_CL, Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_CR

                            blnReturn = CheckSubSystemNote(16, intToolNo, enSubSystem:=enSubSystem)
                        Case Else
                            blnReturn = True
                    End Select
                End If

            Case MethodTypeEnum.ToolLifeMultiTool, MethodTypeEnum.ToolLifeStatusMultiTool, MethodTypeEnum.ToolGaugeStatusMultiTool, MethodTypeEnum.ToolGroupMultiTool
                If GetSpecCode(21, 3) Then
                    blnReturn = CheckSubSystemNote(16, intToolNo, enSubSystem:=enSubSystem) And CheckSubSystemNote(45)
                End If

            Case MethodTypeEnum.ToolOffset

                If intAxisIndex = Okuma.CLDATAPI.Enumerations.ToolOffsetAxisIndexEnum.YI_Axis Then
                    If IsATurretSeletected() Then
                        blnReturn = Not GetSpecCode(3, 0) And GetSpecCode(8, 0) ' CCM AND SYAX
                    ElseIf IsBTurretSeletected() And intAxisIndex = Okuma.CLDATAPI.Enumerations.AllAxisIndexEnum.YI_Axis Then
                        blnReturn = GetBSpecCode(21, 0) ' YBAX
                    ElseIf IsCTurretSeletected() And intAxisIndex = Okuma.CLDATAPI.Enumerations.AllAxisIndexEnum.YI_Axis Then
                        blnReturn = GetBSpecCode(21, 7) ' YCAX
                    End If
                Else
                    blnReturn = True
                End If

                If blnReturn Then
                    Select Case enSubSystem
                        Case Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_RUN, Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_PANEL
                            blnReturn = CheckSubSystemNote(17, intAxisIndex:=intAxisIndex, enSubSystem:=enSubSystem)
                        Case Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_RUN_1, Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_PANEL_1, Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_AL, Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_AR
                            blnReturn = CheckSubSystemNote(19, intAxisIndex:=intAxisIndex, enSubSystem:=enSubSystem)
                        Case Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_RUN_2, _
                            Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_RUN_3, _
                            Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_PANEL_2, _
                            Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_PANEL_3, _
                            Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_BL, Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_BR, _
                            Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_CL, Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_CR
                            blnReturn = CheckSubSystemNote(46, intAxisIndex:=intAxisIndex, enSubSystem:=enSubSystem)
                        Case Else
                            blnReturn = True
                    End Select
                End If


            Case MethodTypeEnum.ToolWearOffset
                If GetSpecCode(21, 5) = True And GetSpecCode(21, 6) = False Then
                    blnReturn = True
                End If

            Case MethodTypeEnum.NoseRCompensation
                Select Case enSubSystem
                    Case Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_RUN, _
                        Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_PANEL
                        blnReturn = CheckSubSystemNote(20, intAxisIndex:=intAxisIndex, enSubSystem:=enSubSystem)

                    Case Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_RUN_1, _
                        Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_PANEL_1, _
                        Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_AL, _
                        Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_AR
                        blnReturn = CheckSubSystemNote(19, intAxisIndex:=intAxisIndex, enSubSystem:=enSubSystem)
                    Case Else
                        blnReturn = True
                End Select


            Case MethodTypeEnum.ToolAdjustment_P300S
                Select Case enSubSystem
                    Case Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_RUN_3, _
                        Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_PANEL_3, _
                        Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_CL, _
                        Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_CR, _
                        Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_2AL
                        blnReturn = True
                End Select

                If intAxisIndex = Okuma.CLDATAPI.Enumerations.ToolOffsetAxisIndexEnum.X_Axis Or _
                    intAxisIndex = Okuma.CLDATAPI.Enumerations.ToolOffsetAxisIndexEnum.Z_Axis Then
                    blnReturn = CheckSubSystemNote(39)
                ElseIf intAxisIndex = Okuma.CLDATAPI.Enumerations.ToolOffsetAxisIndexEnum.YI_Axis Then
                    blnReturn = CheckSubSystemNote(40)
                End If

        End Select

        Return blnReturn

    End Function

    ''' <summary>
    ''' Check Sub System Note specified per function given sub system note number, axis index, cutting position, and sub system if applicable.
    ''' </summary>
    ''' <returns>True if the machine can support the sub system note for the current machine condition</returns>
    Private Function CheckSubSystemNote(ByVal intSubSystemNote As Integer, Optional intToolNo As Integer = -1, Optional intAxisIndex As Integer = -1, Optional ByVal enCuttingPosition As Okuma.CLDATAPI.Enumerations.CuttingPositionEnum = Okuma.CLDATAPI.Enumerations.CuttingPositionEnum.PrincipalAxis1_BaseA, Optional ByVal enSubSystem As Okuma.CLDATAPI.Enumerations.SubSystemEnum = Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_AL) As Boolean
        Dim blnValue As Boolean = False
        Dim objSpec As Okuma.CLDATAPI.DataAPI.CSpec = New Okuma.CLDATAPI.DataAPI.CSpec

        Select Case intSubSystemNote
            Case 1
                '1  When the B turret is selected, a required specification is that “B turret M-axis” NC  spec [3,1] is enabled.
                'When the C turret is selected, a required specification is that “C turret M-axis” NC2 [21, 5] is enabled.
                If IsBTurretSeletected() And GetSpecCode(3, 1) Then
                    blnValue = True
                ElseIf IsCTurretSeletected() And GetBSpecCode(21, 5) Then
                    blnValue = True
                Else
                    blnValue = True
                End If
            Case 2
                '2  A required specification is that “B turret M-axis” NC  spec [3,1] is enabled.
                blnValue = GetSpecCode(3, 1)
            Case 3
                '3  When the B turret or the C turret is selected, the effective range of the argument “tool/station number” is 1 to 12.
                If IsBTurretSeletected() Or IsCTurretSeletected() Then
                    If intToolNo >= 1 And intToolNo <= 12 Then
                        blnValue = True
                    End If
                Else
                    blnValue = True
                End If

            Case 4
                '4  The effective range of the argument “tool/station number” is 1 to 12.
                If intToolNo >= 1 And intToolNo <= 12 Then
                    blnValue = True
                End If
            Case 5
                '5  When the B turret or the C turret is selected, specification is impossible.
                If IsBTurretSeletected() Or IsCTurretSeletected() Then
                    blnValue = False
                Else
                    blnValue = True
                End If
            Case 6
                '6  When the B turret or the C turret is selected, 2 (C-axis) and 3 (W-axis) cannot be specified for the axis parameter.
                If IsBTurretSeletected() Or IsCTurretSeletected() And (intAxisIndex = Okuma.CLDATAPI.Enumerations.AllAxisIndexEnum.W_Axis Or intAxisIndex = Okuma.CLDATAPI.Enumerations.AllAxisIndexEnum.C_Axis) Then
                    blnValue = False
                Else
                    blnValue = True
                End If
            Case 7
                '7  2 (C-axis) and 3 (W-axis) cannot be specified for the axis parameter
                If intAxisIndex = Okuma.CLDATAPI.Enumerations.AllAxisIndexEnum.W_Axis Or intAxisIndex = Okuma.CLDATAPI.Enumerations.AllAxisIndexEnum.C_Axis Then
                    blnValue = False
                Else
                    blnValue = True
                End If
            Case 8
                '8  When the B turret or the C turret is selected, 3 (W-axis) cannot be specified for the axis parameter.
                If IsBTurretSeletected() Or IsCTurretSeletected() And (intAxisIndex = Okuma.CLDATAPI.Enumerations.AllAxisIndexEnum.W_Axis) Then
                    blnValue = False
                Else
                    blnValue = True
                End If
            Case 9
                '9  3 (W-axis) cannot be specified for the axis parameter.
                If intAxisIndex = Okuma.CLDATAPI.Enumerations.AllAxisIndexEnum.W_Axis Then
                    blnValue = False
                Else
                    blnValue = True
                End If
            Case 10
                '10  When the A turret is selected,
                '-> 3 (W-axis) cannot be specified for the axis parameter, if the 2nd spindle is selected, OR the specification of the LT specification (NC spec [4,0]) is disabled and the specification of the subspindle NC spec [4,1] is enabled.
                'When the B turret or the C turret is selected,
                '-> 5 (YI-axis) can be specified for axis index parameter if: 
                ' - In case of B Turret, B-TRT Y-AXIS YBAX (NC spec code 2 [21,0]) is effective
                ' - In case of C Turret, C-TRT Y-AXIS YCAX (NC spec code 2 [21,7]) is effective

                '-> 3 (W-axis) cannot be specified for the axis parameter if the 2nd spindle is selected. 
                '-> 3 (W-axis) cannot be specified for the axis parameter if the 1st spindle is selected and if one of the following conditions are not met.
                '- The specification of the LT specification (NC spec [4,0])  is disabled and the specification of the subspindle NC spec [4,1] is enabled
                '- The specification of the Auto Tailstock (NC spec [27,3]) is enabled
                '- The specification of the NC tailstock (NC spec [27,5]) is enabled.

                If IsATurretSeletected() Then
                    If intAxisIndex = Okuma.CLDATAPI.Enumerations.AllAxisIndexEnum.W_Axis Then
                        If IsSecondSpindleSelected() Then
                            blnValue = False
                        ElseIf GetSpecCode(4, 0) = False And GetSpecCode(4, 1) = True Then
                            blnValue = False
                        Else
                            blnValue = True
                        End If
                    Else
                        blnValue = True
                    End If
                ElseIf IsBTurretSeletected() Or IsCTurretSeletected() Then
                    If intAxisIndex = Okuma.CLDATAPI.Enumerations.AllAxisIndexEnum.YI_Axis Then
                        If IsBTurretSeletected() And GetBSpecCode(21, 0) Then
                            blnValue = True
                        ElseIf IsCTurretSeletected() And GetBSpecCode(21, 7) Then
                            blnValue = True
                        Else
                            blnValue = True
                        End If
                    ElseIf (intAxisIndex = Okuma.CLDATAPI.Enumerations.AllAxisIndexEnum.W_Axis) Then
                        If IsFirstSpindleSelected() Then
                            If GetSpecCode(4, 0) = False And _
                                GetSpecCode(4, 1) = True Then
                                blnValue = True
                            ElseIf GetSpecCode(27, 3) Then
                                blnValue = True
                            ElseIf GetSpecCode(27, 5) Then
                                blnValue = True
                            End If
                        End If
                    Else
                        blnValue = True
                    End If
                Else
                    blnValue = True
                End If

            Case 11
                '11  When the 2nd spindle is selected, 
                'the specification of the LT specification (NC spec [4,0]) is disabled, 
                'and the specification of the subspindle (NC spec [4,1]) is enabled, 
                '3 (W-axis) cannot be specified for the axis parameter.
                If IsSecondSpindleSelected() Then
                    If (intAxisIndex = Okuma.CLDATAPI.Enumerations.AllAxisIndexEnum.W_Axis) Then
                        If GetSpecCode(4, 0) = False And _
                            GetSpecCode(4, 1) = True Then
                            blnValue = False
                        Else
                            blnValue = True
                        End If
                    Else
                        blnValue = True
                    End If
                Else
                    blnValue = True
                End If
            Case 12
                '12  5 (YI-axis) can be specified for axis index parameter if: 
                ' - In case of B Turret, B-TRT Y-AXIS YBAX (NC spec code 2 [21,0]) is effective
                ' - In case of C Turret, C-TRT Y-AXIS YCAX (NC spec code 2 [21,7]) is effective

                'When the 2nd spindle is selected, 3 (W-axis) cannot be specified for the axis parameter.
                'When the 1st spindle is selected and if one of the following conditions are not met, 3 (W-axis) cannot be specified for the axis parameter:
                '- The specification of the LT specification (NC spec [4,0]) is disabled and the specification of the subspindle NC spec [4,1] is enabled.
                '- The specification of the Auto Tailstock (NC spec [27,3]) is enabled.
                '- The specification of the NC tailstock (NC spec [27,5]) is enabled.
                If (intAxisIndex = Okuma.CLDATAPI.Enumerations.AllAxisIndexEnum.YI_Axis) Then
                    If IsBTurretSeletected() And GetBSpecCode(21, 0) Then
                        blnValue = True
                    ElseIf IsCTurretSeletected() And GetBSpecCode(21, 7) Then
                        blnValue = True
                    Else
                        blnValue = True
                    End If
                ElseIf (intAxisIndex = Okuma.CLDATAPI.Enumerations.AllAxisIndexEnum.W_Axis) Then
                    If IsFirstSpindleSelected() Then
                        If GetSpecCode(4, 0) = False And _
                            GetSpecCode(4, 1) = True Then
                            blnValue = True
                        ElseIf GetSpecCode(27, 3) Then
                            blnValue = True
                        ElseIf GetSpecCode(27, 5) Then
                            blnValue = True
                        End If
                    End If
                Else
                    blnValue = True
                End If
            Case 13
                '13  When the specification of the LT specification (NC spec [4,0]) is disabled 
                'and the specification of the subspindle NC spec [4,1] is enabled, 
                '3 (W-axis) cannot be specified for the axis parameter.
                If (intAxisIndex = Okuma.CLDATAPI.Enumerations.AllAxisIndexEnum.W_Axis) Then
                    If GetSpecCode(4, 0) = False And GetSpecCode(4, 1) = True Then
                        blnValue = False
                    Else
                        blnValue = True
                    End If
                Else
                    blnValue = True
                End If

            Case 14
                '14  5 (YI-axis) can be specified for axis index parameter if: 
                '- In case of B Turret, B-TRT Y-AXIS YBAX (NC spec code 2 [21,0]) is effective
                '- In case of C Turret, C-TRT Y-AXIS YCAX (NC spec code 2 [21,7]) is effective
                'When one of the following conditions is not met, 3 (W-axis) cannot be specified for the axis parameter:
                '- The specification of the LT specification (NC spec [4,0]) is disabled and the specification of the subspindle NC spec [4,1] is enabled.
                '- The specification of the Auto Tailstock (NC spec [27,3]) is enabled.
                '- The specification of the NC tailstock (NC spec [27,5]) is enabled.
                If (intAxisIndex = Okuma.CLDATAPI.Enumerations.AllAxisIndexEnum.YI_Axis) Then
                    If IsBTurretSeletected() And GetBSpecCode(21, 0) Then
                        blnValue = True
                    ElseIf IsCTurretSeletected() And GetBSpecCode(21, 7) Then
                        blnValue = True
                    Else
                        blnValue = True
                    End If
                ElseIf (intAxisIndex = Okuma.CLDATAPI.Enumerations.AllAxisIndexEnum.W_Axis) Then
                    If GetSpecCode(4, 0) = False And _
                            GetSpecCode(4, 1) = True Then
                        blnValue = True
                    ElseIf GetSpecCode(27, 3) Then
                        blnValue = True
                    ElseIf GetSpecCode(27, 5) Then
                        blnValue = True
                    End If
                Else
                    blnValue = True
                End If
            Case 15
                '15  When B or C turret is selected:
                '- If the Double Tooling specification NC spec [5,7] is enabled the effective range of the argument “tool/station number” is 1 to 12 and 21 to 32.
                '- If the Double Tooling specification NC spec [5,7] is disabled the effective range of the argument “tool/station number” is 1 to max available tool. 
                '- In case of B turret and Double Tooling specification NC spec [5,7] is not active and the following specifcations are valid:
                '       Mirror Image NC spec [2,1] is ON
                '       Vertical Lathe NC spec [4,4] is ON
                '       Flat Bed NC spec [2,7] is OFF
                '       Tool Base NC B spec [10,7] is ON
                '       The effective range of the argument “tool/station number” is 1 to 24
                If IsBTurretSeletected() Or IsCTurretSeletected() Then
                    If GetSpecCode(5, 7) Then 'DBTL
                        ' check parameter value
                        If (intToolNo >= 1 Or intToolNo <= 12) Or (intToolNo >= 21 Or intToolNo <= 32) Then
                            blnValue = True
                        End If
                    Else
                        If IsBTurretSeletected() And GetSpecCode(2, 1) And GetSpecCode(4, 4) And GetSpecCode(2, 7) = False And GetBSpecCode(10, 7) Then
                            If (intToolNo >= 1 Or intToolNo <= 24) Then
                                blnValue = True
                            End If
                        Else
                            blnValue = True
                        End If
                    End If
                Else
                    blnValue = True
                End If

            Case 16
                '16  
                '- When the Double Tooling specification NC spec [5,7] is enabled,
                'The effective range of the argument “tool/station number” is 1 to 12 and 21 to 32.
                '- When the Double Tooling specification NC spec [5,7] is disabled,
                'The effective range of the argument “tool/station number” is 1 to max available tool.
                '- In case of B turret and Double Tooling specification NC spec [5,7] is not active and the following specifcations are valid:
                'Mirror Image NC spec [2,1] is ON
                'Vertical Lathe NC spec [4,4] is ON
                'Flat Bed NC spec [2,7] is OFF
                'Tool Base NC B spec [10,7] is ON
                'The effective range of the argument “tool/station number” is 1 to 24

                If GetSpecCode(5, 7) Then 'DBTL
                    ' check parameter value
                    If (intToolNo >= 1 Or intToolNo <= 12) Or (intToolNo >= 21 Or intToolNo <= 32) Then
                        blnValue = True
                    End If
                Else
                    If IsBTurretSeletected() And GetSpecCode(2, 1) And GetSpecCode(4, 4) And GetSpecCode(2, 7) = False And GetBSpecCode(10, 7) Then
                        If (intToolNo >= 1 Or intToolNo <= 24) Then
                            blnValue = True
                        End If
                    Else
                        blnValue = True
                    End If
                End If

            Case 17
                '17  When the A turret is selected, a required specification is that tool compensation multi-system  (NC spec [21,6]) is disabled.
                '5 (YI-axis) can be specified for axis index parameter if: 
                '- In case of B Turret, B-TRT Y-AXIS YBAX (NC spec code 2 [21,0]) is effective
                '- In case of C Turret, C-TRT Y-AXIS YCAX (NC spec code 2 [21,7]) is effective 
                If IsATurretSeletected() Then
                    blnValue = Not GetSpecCode(21, 6) ' 'TLPO
                ElseIf IsBTurretSeletected() And intAxisIndex = Okuma.CLDATAPI.Enumerations.AllAxisIndexEnum.YI_Axis Then
                    blnValue = GetBSpecCode(21, 0) ' YBAX
                ElseIf IsCTurretSeletected() And intAxisIndex = Okuma.CLDATAPI.Enumerations.AllAxisIndexEnum.YI_Axis Then
                    blnValue = GetBSpecCode(21, 7) ' YCAX
                Else
                    blnValue = True
                End If
            Case 18
                '18  5 (YI-axis) cannot be specified for the axis parameter.
                If intAxisIndex = Okuma.CLDATAPI.Enumerations.AllAxisIndexEnum.YI_Axis Then
                    blnValue = False
                Else
                    blnValue = True
                End If
            Case 19
                '19  A required specification is that tool compensation multi-system (NC spec [21,6]) is disabled.
                blnValue = Not GetSpecCode(21, 6) 'TLPO
            Case 20
                '20  When the A turret is selected, a required specification is that tool compensation multi-system (NC spec [21,6]) is disabled.
                If IsATurretSeletected() Then
                    blnValue = Not GetSpecCode(21, 6) 'TLPO
                Else
                    blnValue = True
                End If
            Case 21
                '21  When the A turret is selected, a required specification is that 'B-axis control' NC spec [8,7] is disabled.
                'When B or C turret is selected:
                'If the double tooling is enabled the effective range of the argument “tool/station number” is 1 to 12 and 21 to 32.
                'If the double tooling is disabled the effective range of the argument “tool/station number” is 1 to max available tool.
                If IsATurretSeletected() Then
                    blnValue = Not GetSpecCode(8, 7) 'BAX
                ElseIf IsBTurretSeletected() Or IsCTurretSeletected() Then
                    If GetSpecCode(5, 7) Then 'DBTL
                        If (intToolNo >= 1 Or intToolNo <= 12) Or (intToolNo >= 21 Or intToolNo <= 32) Then
                            blnValue = True
                        End If
                    Else
                        'not checking max tool
                        blnValue = True
                    End If
                Else
                    blnValue = True
                End If
            Case 22
                '22. A required specification is that B-AXIS CONTROL BAX (NC spec [8,7]) is disabled.
                blnValue = Not GetSpecCode(8, 7) 'BAX
            Case 23
                '23  When the A turret is selected,
                '-> 3 (W-axis) cannot be specified for the axis parameter if the 2nd spindle is selected, 
                'the specification of LT specification (NC spec [4,0]) is disabled, and the specification of the subspindle NC spec [4,1] is enabled.
                'When the B turret or the C turret is selected,
                '-> 5 (YI-axis) can be specified for axis index parameter if: 
                '- In case of B Turret, B-TRT Y-AXIS YBAX (NC spec code 2 [21,0]) is effective
                '- In case of C Turret, C-TRT Y-AXIS YCAX (NC spec code 2 [21,7]) is effective
                '-> 3 (W-axis) cannot be specified for the axis parameter if the 1st spindle is selected and the specification of the LT specification (NC spec [4,0]) is enable.
                '-> 3 (W-axis) cannot be specified for the axis parameter if the 1st spindle is selected and all the specifications of the subspindle NC spec [4,1], Auto Tailstock (NC spec [27,3]), and NC tailstock (NC spec [27,5]) are disabled.
                '-> 3 (W-axis) cannot be specified for the axis parameter if the 2nd spindle is selected.
                If IsATurretSeletected() Then
                    If intAxisIndex = Okuma.CLDATAPI.Enumerations.AllAxisIndexEnum.W_Axis Then
                        If IsSecondSpindleSelected() Then
                            blnValue = False
                        ElseIf GetSpecCode(4, 0) = False And GetSpecCode(4, 1) Then
                            blnValue = False
                        Else
                            blnValue = True
                        End If
                    Else
                        blnValue = True
                    End If
                ElseIf IsBTurretSeletected() Or IsCTurretSeletected() Then
                    If (intAxisIndex = Okuma.CLDATAPI.Enumerations.AllAxisIndexEnum.YI_Axis) Then
                        If IsBTurretSeletected() And GetBSpecCode(21, 0) Then
                            blnValue = True
                        ElseIf IsCTurretSeletected() And GetBSpecCode(21, 7) Then
                            blnValue = True
                        Else
                            blnValue = True
                        End If
                    ElseIf (intAxisIndex = Okuma.CLDATAPI.Enumerations.AllAxisIndexEnum.W_Axis) Then
                        If IsFirstSpindleSelected() Then
                            If GetSpecCode(4, 0) Then
                                blnValue = False
                            ElseIf GetSpecCode(4, 1) = False And GetSpecCode(27, 3) = False And GetSpecCode(27, 5) = False Then
                                blnValue = False
                            Else
                                blnValue = True
                            End If
                        End If
                    Else
                        blnValue = True
                    End If
                Else
                    blnValue = True
                End If
            Case 24
                '24 5 (YI-axis) can be specified for axis index parameter if: 
                ' - In case of B Turret, B-TRT Y-AXIS YBAX (NC spec code 2 [21,0]) is effective
                ' - In case of C Turret, C-TRT Y-AXIS YCAX (NC spec code 2 [21,7]) is effective
                'When the 1st spindle is selected and the specification of the LT specification (NC spec [4,0]) is enable, 3 (W-axis) cannot be specified for the axis parameter.
                'When the 1st spindle is selected and all the specifications of the subspindle (NC spec [4,1]), Auto Tailstock (NC spec [27,3]), and NC tailstock (NC spec [27,5]) are disabled, 3 (W-axis) cannot be specified for the axis parameter.
                'When the 2nd spindle is selected, 3 (W-axis) cannot be specified for the axis parameter.
                If (intAxisIndex = Okuma.CLDATAPI.Enumerations.AllAxisIndexEnum.YI_Axis) Then
                    If IsBTurretSeletected() And GetBSpecCode(21, 0) Then
                        blnValue = True
                    ElseIf IsCTurretSeletected() And GetBSpecCode(21, 7) Then
                        blnValue = True
                    Else
                        blnValue = True
                    End If
                ElseIf (intAxisIndex = Okuma.CLDATAPI.Enumerations.AllAxisIndexEnum.W_Axis) Then
                    If IsFirstSpindleSelected() Then
                        If GetSpecCode(4, 0) Then
                            blnValue = False
                        ElseIf GetSpecCode(4, 1) = False And GetSpecCode(27, 3) = False And GetSpecCode(27, 5) = False Then
                            blnValue = False
                        Else
                            blnValue = True
                        End If
                    End If
                Else
                    blnValue = True
                End If

            Case 25
                '25  5 (YI-axis) can be specified for axis index parameter if: 
                ' - In case of B Turret, B-TRT Y-AXIS YBAX (NC spec code 2 [21,0]) is effective
                ' - In case of C Turret, C-TRT Y-AXIS YCAX (NC spec code 2 [21,7]) is effective
                'When the specification of the LT specification (NC spec [4,0]) is enabled, 3 (W-axis) cannot be specified for the axis parameter.
                'When all the specifications of the subspindle NC spec [4,1], Auto Tailstock (NC spec [27,3]), and NC tailstock (NC spec [27,5]) are disabled, 3 (W-axis) cannot be specified for the axis parameter.
                If (intAxisIndex = Okuma.CLDATAPI.Enumerations.AllAxisIndexEnum.YI_Axis) Then
                    If IsBTurretSeletected() And GetBSpecCode(21, 0) Then
                        blnValue = True
                    ElseIf IsCTurretSeletected() And GetBSpecCode(21, 7) Then
                        blnValue = True
                    Else
                        blnValue = True
                    End If
                ElseIf (intAxisIndex = Okuma.CLDATAPI.Enumerations.AllAxisIndexEnum.W_Axis) Then
                    If GetSpecCode(4, 0) Then
                        blnValue = False
                    ElseIf GetSpecCode(4, 1) = False And GetSpecCode(27, 3) = False And GetSpecCode(27, 5) = False Then
                        blnValue = False
                    Else
                        blnValue = True
                    End If
                Else
                    blnValue = True
                End If
            Case 26
                '26  When the A turret is selected,
                '-> 3 (W-axis) cannot be specified for the axis parameter if
                '   the 2nd spindle is selected
                '   the specification of the LT specification (NC spec [4,0]) is disabled, and the specification of the subspindle (NC spec [4,1]) is enabled.
                'When the B turret or the C turret is selected,
                '-> 5 (YI-axis) can be specified for axis index parameter if: 
                ' - In case of B Turret, B-TRT Y-AXIS YBAX (NC spec code 2 [21,0]) is effective
                ' - In case of C Turret, C-TRT Y-AXIS YCAX (NC spec code 2 [21,7]) is effective
                '-> 3 (W-axis) cannot be specified for the axis parameter if the 1st spindle is selected and the specification of the LT specification (NC spec [4,0]) is enabled.
                '-> 3 (W-axis) cannot be specified for the axis parameter if the 1st spindle is selected and the specification of the subspindle (NC spec [4,1]) is disabled.
                '-> 3 (W-axis) cannot be specified for the axis parameter if the 1st spindle is selected and 'New W-axis' NC spec [2,4] is not valid.
                '-> 3 (W-axis) cannot be specified for the axis parameter if the 2nd spindle is selected.
                If IsATurretSeletected() Then
                    If intAxisIndex = Okuma.CLDATAPI.Enumerations.AllAxisIndexEnum.W_Axis Then
                        If IsSecondSpindleSelected() Then
                            blnValue = False
                        ElseIf GetSpecCode(4, 0) = False And GetSpecCode(4, 1) Then
                            blnValue = False
                        Else
                            blnValue = True
                        End If
                    Else
                        blnValue = True
                    End If
                ElseIf IsBTurretSeletected() Or IsCTurretSeletected() Then
                    If (intAxisIndex = Okuma.CLDATAPI.Enumerations.AllAxisIndexEnum.YI_Axis) Then
                        If IsBTurretSeletected() And GetBSpecCode(21, 0) Then
                            blnValue = True
                        ElseIf IsCTurretSeletected() And GetBSpecCode(21, 7) Then
                            blnValue = True
                        Else
                            blnValue = True
                        End If
                    ElseIf (intAxisIndex = Okuma.CLDATAPI.Enumerations.AllAxisIndexEnum.W_Axis) Then
                        If IsFirstSpindleSelected() Then
                            If GetSpecCode(4, 0) Then   'LT specification (NC spec [4,0]) is enabled.
                                blnValue = False
                            ElseIf GetSpecCode(4, 1) = False Then ' subspindle (NC spec [4,1]) is disabled.
                                blnValue = False
                            ElseIf GetSpecCode(2, 4) = False Then ' 'New W-axis' NC spec [2,4] is not valid.
                                blnValue = False
                            Else
                                blnValue = True
                            End If
                        End If
                    Else
                        blnValue = True
                    End If
                Else
                    blnValue = True
                End If
            Case 27
                '27   5 (YI-axis) can be specified for axis index parameter if: 
                '- In case of B Turret, B-TRT Y-AXIS YBAX (NC spec code 2 [21,0]) is effective
                '- In case of C Turret, C-TRT Y-AXIS YCAX (NC spec code 2 [21,7]) is effective
                'When the 1st spindle is selected and the specification of the LT specification (NC spec [4,0]) is enabled, 3 (W-axis) cannot be specified for the axis parameter.
                'When the 1st spindle is selected and the specification of the subspindle (NC spec [4,1]) is disabled, 3 (W-axis) cannot be specified for the axis parameter.
                'When the 1st spindle is selected and 'New W-axis' NC spec [2,4] is not valid, 3 (W-axis) cannot be specified for the axis parameter.
                'When the 2nd spindle is selected, 3 (W-axis) cannot be specified for the axis parameter.
                If (intAxisIndex = Okuma.CLDATAPI.Enumerations.AllAxisIndexEnum.YI_Axis) Then
                    If IsBTurretSeletected() And GetBSpecCode(21, 0) Then
                        blnValue = True
                    ElseIf IsCTurretSeletected() And GetBSpecCode(21, 7) Then
                        blnValue = True
                    Else
                        blnValue = True
                    End If
                ElseIf (intAxisIndex = Okuma.CLDATAPI.Enumerations.AllAxisIndexEnum.W_Axis) Then
                    If IsFirstSpindleSelected() Then
                        If GetSpecCode(4, 0) Then   'LT specification (NC spec [4,0]) is enabled.
                            blnValue = False
                        ElseIf GetSpecCode(4, 1) = False Then ' subspindle (NC spec [4,1]) is disabled.
                            blnValue = False
                        ElseIf GetSpecCode(2, 4) = False Then ' 'New W-axis' NC spec [2,4] is not valid.
                            blnValue = False
                        Else
                            blnValue = True
                        End If
                    End If
                Else
                    blnValue = True
                End If
            Case 28
                '28   5 (YI-axis) can be specified for axis index parameter if: 
                ' - In case of B Turret, B-TRT Y-AXIS YBAX (NC spec code 2 [21,0]) is effective
                ' - In case of C Turret, C-TRT Y-AXIS YCAX (NC spec code 2 [21,7]) is effective
                'When the specification of the LT specification (NC spec [4,0]) is enabled, 3 (W-axis) cannot be specified for the axis parameter.
                'When the specification of the subspindle (NC spec [4,1]) is disabled, 3 (W-axis) cannot be specified for the axis parameter.
                'When 'New W-axis' NC spec [2,4] is not valid, 3 (W-axis) cannot be specified for the axis parameter. 
                If (intAxisIndex = Okuma.CLDATAPI.Enumerations.AllAxisIndexEnum.YI_Axis) Then
                    If IsBTurretSeletected() And GetBSpecCode(21, 0) Then
                        blnValue = True
                    ElseIf IsCTurretSeletected() And GetBSpecCode(21, 7) Then
                        blnValue = True
                    Else
                        blnValue = True
                    End If
                ElseIf (intAxisIndex = Okuma.CLDATAPI.Enumerations.AllAxisIndexEnum.W_Axis) Then
                    If GetSpecCode(4, 0) Then   'LT specification (NC spec [4,0]) is enabled.
                        blnValue = False
                    ElseIf GetSpecCode(4, 1) = False Then ' subspindle (NC spec [4,1]) is disabled.
                        blnValue = False
                    ElseIf GetSpecCode(2, 4) = False Then ' 'New W-axis' NC spec [2,4] is not valid.
                        blnValue = False
                    Else
                        blnValue = True
                    End If
                Else
                    blnValue = True
                End If

            Case 31
                '31  When the B turret is selected, 5 (YI-axis) cannot be specified for the axis parameter.
                If (intAxisIndex = Okuma.CLDATAPI.Enumerations.AllAxisIndexEnum.YI_Axis) Then
                    If IsBTurretSeletected() Then
                        blnValue = False
                    Else
                        blnValue = True
                    End If
                Else
                    blnValue = True
                End If
            Case 32
                '32  When "Steadyrest ZB-axis control" NC spec [31,0] is enabled and the B turret is selected, 0 (X-axis) cannot be specified for the axis parameter.
                If (intAxisIndex = Okuma.CLDATAPI.Enumerations.AllAxisIndexEnum.X_Axis) Then
                    If IsBTurretSeletected() And GetSpecCode(31, 0) Then
                        blnValue = False
                    Else
                        blnValue = True
                    End If
                Else
                    blnValue = True
                End If
            Case 33
                '33  When "Steadyrest ZB-axis control" NC spec [31,0] is enabled, 0 (X-axis) cannot be specified for the axis parameter.
                If (intAxisIndex = Okuma.CLDATAPI.Enumerations.AllAxisIndexEnum.X_Axis) Then
                    If GetSpecCode(31, 0) Then
                        blnValue = False
                    Else
                        blnValue = True
                    End If
                Else
                    blnValue = True
                End If
            Case 34
                '34  A required specification is that the “C turret M-axis” NC2 [21, 5] is enabled.
                blnValue = GetBSpecCode(21, 5)
            Case 35
                '35   (NC-B No3 Bit6) = (ON) or (NC-B No27 Bit2)=(ON) is required. 
                blnValue = GetBSpecCode(3, 6) Or GetBSpecCode(27, 2)
            Case 36
                '36  (NC-B No3 Bit7)=(ON) is required.
                blnValue = GetBSpecCode(3, 7)
            Case 37
                '37  (NC-B No3 Bit7, NC No13 Bit3)=(ON, ON) is required.
                blnValue = GetBSpecCode(3, 7) And GetSpecCode(13, 3)
            Case 38
                '*38  (NC-B No3 Bit5)=(ON) is required.
                blnValue = GetBSpecCode(3, 5)
            Case 39
                '39  (NC-B No3 Bit6)=( ON) is required.
                blnValue = objSpec.GetBSpecCode(3, 0)
            Case 40
                '40  (NC-B No3 Bit6, NC No3 Bit0, NC No8 Bit0)=(ON,ON,ON) is required.
                blnValue = objSpec.GetBSpecCode(3, 6) And objSpec.GetSpecCode(3, 0) And objSpec.GetSpecCode(8, 0)
            Case 42
                '42  (NC-B No3 Bit6, NC No21 Bit3)=(ON,ON) is required.
                blnValue = objSpec.GetBSpecCode(3, 6) And objSpec.GetSpecCode(21, 3)
            Case 43
                '43  (NC-B No3 Bit6, NC No2 Bit0)=(ON,ON) or (NC-B No27 Bit2)=(ON)is required.
                blnValue = (objSpec.GetBSpecCode(3, 6) And objSpec.GetSpecCode(2, 0)) Or objSpec.GetBSpecCode(27, 2)
            Case 44
                '44  (NC-B No3 Bit6, NC No2 Bit0)=(ON, ON) is required.
                blnValue = objSpec.GetBSpecCode(3, 6) And objSpec.GetSpecCode(2, 0)
            Case 45
                '45  (NC-B No27 Bit2)=(ON)is required.
                blnValue = objSpec.GetBSpecCode(27, 2)
            Case 46
                '46  5 (YI-axis) can be specified for axis index parameter if: 
                '- In case of B Turret, B-TRT Y-AXIS YBAX (NC spec code 2 [21,0]) is effective
                '- In case of C Turret, C-TRT Y-AXIS YCAX (NC spec code 2 [21,7]) is effective
                If intAxisIndex = Okuma.CLDATAPI.Enumerations.AllAxisIndexEnum.YI_Axis Then
                    If IsBTurretSeletected() And GetBSpecCode(21, 0) Then
                        blnValue = True
                    ElseIf IsCTurretSeletected() And GetBSpecCode(21, 7) Then
                        blnValue = True
                    End If
                Else
                    blnValue = True
                End If

            Case 47
                'a) "OFFSET BASE FIX" is NC-B spec. code No3 Bit7.
                'b) "L TOOL MAC INFORM" is NC-B spec. code No27 Bit2.
                'a):ON and b): ON are necessary.
                blnValue = GetBSpecCode(3, 7) And GetBSpecCode(27, 2)

        End Select

        Return blnValue
    End Function

    ''' <summary>
    ''' Get control type of this machine
    ''' </summary>
    ''' <returns>An Okuma.CLDATAPI.Enumerations.ControlTypeEnum</returns>
    ''' <remarks></remarks>
    Private Function GetControlType() As Okuma.CLDATAPI.Enumerations.ControlTypeEnum
        Dim objSpec As Okuma.CLDATAPI.DataAPI.CSpec = New Okuma.CLDATAPI.DataAPI.CSpec
        Return objSpec.GetControlType()
    End Function

    ''' <summary>
    ''' Get TD Mode on P300S control 
    ''' </summary>
    ''' <returns>True if the control is currently in TD mode. Otherwise, it is in TL mode</returns>
    ''' <remarks></remarks>
    Protected Function IsTDMode() As Boolean
        Dim objMachine As Okuma.CLDATAPI.DataAPI.CMachine = New Okuma.CLDATAPI.DataAPI.CMachine
        Return objMachine.GetTDMode()
    End Function

    ''' <summary>
    ''' Check if the control type and its TD/TL mode can be used for functions designed to work for the following control types and TD/TL mode if applicable:
    ''' P200
    ''' P300L AND IsLTMIMSpecOn() = true
    ''' P300S AND IsLTMIMSpecOn() = true AND in TL mode
    ''' </summary>
    ''' <returns>True if it is one of the conditions is met</returns>
    ''' <remarks>Sample codes only. It does not detect all specifications of each machine</remarks>
    Protected Function IsP200P300LP300S_TL() As Boolean
        Dim blnValue As Boolean = False
        If GetControlType() = Okuma.CLDATAPI.Enumerations.ControlTypeEnum.P200 _
            Or GetControlType() = Okuma.CLDATAPI.Enumerations.ControlTypeEnum.P300L _
            Or IsP300S_TL() Then
            blnValue = True
        End If

        Return blnValue
    End Function

    ''' <summary>
    ''' Check if the control type and its TD/TL mode can be used for functions designed to work for the following control types and TD/TL mode if applicable:
    ''' P100II
    ''' P200
    ''' P300L AND IsLTMIMSpecOn() = true
    ''' P300S AND IsLTMIMSpecOn() = true AND in TL mode
    ''' </summary>
    ''' <returns>True if it is one of the conditions is met</returns>
    ''' <remarks>Sample codes only. It does not detect all specifications of each machine</remarks>
    Protected Function IsP100P200P300LP300S_TL() As Boolean
        Dim blnValue As Boolean = False
        If GetControlType() = Okuma.CLDATAPI.Enumerations.ControlTypeEnum.P100 _
            Or GetControlType() = Okuma.CLDATAPI.Enumerations.ControlTypeEnum.P200 _
            Or IsP300L() _
            Or IsP300S_TL() Then
            blnValue = True
        End If

        Return blnValue
    End Function

    ''' <summary>
    ''' Check if the control type and its TD/TL mode can be used for functions designed to work for the following control types and TD/TL mode if applicable:
    ''' P200
    ''' P300L AND IsLTMIMSpecOn() = FALSE ==> will be functions like P100II/P200
    ''' P300S AND IsLTMIMSpecOn() = FALSE ==> will be functions like P100II/P200
    ''' </summary>
    ''' <returns>True if it is one of the conditions is met</returns>
    ''' <remarks>Sample codes only. It does not detect all specifications of each machine</remarks>
    Protected Function IsP200() As Boolean
        Dim objSpec As Okuma.CLDATAPI.DataAPI.CSpec = New Okuma.CLDATAPI.DataAPI.CSpec
        Dim blnValue As Boolean = False
        If objSpec.GetControlType() = Okuma.CLDATAPI.Enumerations.ControlTypeEnum.P200 _
            Or (objSpec.GetControlType() = Okuma.CLDATAPI.Enumerations.ControlTypeEnum.P300L And objSpec.IsLTMIMSpecOn() = False) _
            Or (objSpec.GetControlType() = Okuma.CLDATAPI.Enumerations.ControlTypeEnum.P300SLP And objSpec.IsLTMIMSpecOn() = False) Then
            blnValue = True
        End If

        Return blnValue
    End Function

    ''' <summary>
    ''' Check if the control type and its TD/TL mode can be used for functions designed to work for the following control types and TD/TL mode if applicable:
    ''' P100II
    ''' P200
    ''' P300L AND IsLTMIMSpecOn() = FALSE ==> will be functions like P100II/P200
    ''' P300S AND IsLTMIMSpecOn() = FALSE ==> will be functions like P100II/P200
    ''' </summary>
    ''' <returns>True if it is one of the conditions is met</returns>
    ''' <remarks>Sample codes only. It does not detect all specifications of each machine</remarks>
    Protected Function IsP100P200() As Boolean
        Dim objSpec As Okuma.CLDATAPI.DataAPI.CSpec = New Okuma.CLDATAPI.DataAPI.CSpec
        Dim blnValue As Boolean = False
        If GetControlType() = Okuma.CLDATAPI.Enumerations.ControlTypeEnum.P100 _
            Or objSpec.GetControlType() = Okuma.CLDATAPI.Enumerations.ControlTypeEnum.P200 _
            Or (objSpec.GetControlType() = Okuma.CLDATAPI.Enumerations.ControlTypeEnum.P300L And objSpec.IsLTMIMSpecOn() = False) _
            Or (objSpec.GetControlType() = Okuma.CLDATAPI.Enumerations.ControlTypeEnum.P300SLP And objSpec.IsLTMIMSpecOn() = False) Then
            blnValue = True
        End If

        Return blnValue
    End Function

    ''' <summary>
    ''' Check if the control type and its TD/TL mode can be used for functions designed to work for the following control types and TD/TL mode if applicable:
    ''' P100II
    ''' P200
    ''' P300L AND IsLTMIMSpecOn() = ON
    ''' </summary>
    ''' <returns>True if it is one of the conditions is met</returns>
    ''' <remarks>Sample codes only. It does not detect all specifications of each machine</remarks>
    Protected Function IsP100P200P300L() As Boolean
        Dim objSpec As Okuma.CLDATAPI.DataAPI.CSpec = New Okuma.CLDATAPI.DataAPI.CSpec
        Dim blnValue As Boolean = False
        If GetControlType() = Okuma.CLDATAPI.Enumerations.ControlTypeEnum.P100 _
            Or GetControlType() = Okuma.CLDATAPI.Enumerations.ControlTypeEnum.P200 _
            Or IsP300L() Then
            blnValue = True
        End If

        Return blnValue
    End Function

    ''' <summary>
    ''' Check if the control type and its TD/TL mode can be used for functions designed to work for the following control types and TD/TL mode if applicable:
    ''' P100II
    ''' P200
    ''' P300S AND IsLTMIMSpecOn() = ON and TD Mode = true
    ''' </summary>
    ''' <returns>True if it is one of the conditions is met</returns>
    ''' <remarks>Sample codes only. It does not detect all specifications of each machine</remarks>
    Protected Function IsP100P200P300S_TD() As Boolean
        Dim objSpec As Okuma.CLDATAPI.DataAPI.CSpec = New Okuma.CLDATAPI.DataAPI.CSpec
        Dim blnValue As Boolean = False
        If GetControlType() = Okuma.CLDATAPI.Enumerations.ControlTypeEnum.P100 _
            Or GetControlType() = Okuma.CLDATAPI.Enumerations.ControlTypeEnum.P200 _
            Or IsP300S_TD() Then
            blnValue = True
        End If

        Return blnValue
    End Function

    ''' <summary>
    ''' Check if the control type and its TD/TL mode can be used for functions designed to work for the following control types and TD/TL mode if applicable:
    ''' P300L AND IsLTMIMSpecOn() = ON 
    ''' </summary>
    ''' <returns>True if it is one of the conditions is met</returns>
    ''' <remarks>Sample codes only. It does not detect all specifications of each machine</remarks>
    Protected Function IsP300L() As Boolean
        Dim objSpec As Okuma.CLDATAPI.DataAPI.CSpec = New Okuma.CLDATAPI.DataAPI.CSpec
        Dim blnValue As Boolean = False
        If GetControlType() = Okuma.CLDATAPI.Enumerations.ControlTypeEnum.P300L And objSpec.IsLTMIMSpecOn() = True Then blnValue = True
        Return blnValue
    End Function

    ''' <summary>
    ''' Detect if the control type and its TD/TL mode can be used for functions designed to work for the following control types and TD/TL mode:
    ''' P300S AND IsLTMIMSpecOn() = ON and TD Mode = true
    ''' </summary>
    ''' <returns>True if it is one of the conditions is met</returns>
    ''' <remarks>Sample codes only. It does not detect all specifications of each machine</remarks>
    Protected Function IsP300S_TD() As Boolean
        Dim objSpec As Okuma.CLDATAPI.DataAPI.CSpec = New Okuma.CLDATAPI.DataAPI.CSpec
        Dim blnValue As Boolean = False
        If GetControlType() = Okuma.CLDATAPI.Enumerations.ControlTypeEnum.P300SLP And objSpec.IsLTMIMSpecOn() = True And IsTDMode() = True Then blnValue = True
        Return blnValue
    End Function

    ''' <summary>
    ''' Detect if the control type and its TD/TL mode can be used for functions designed to work for the following control types and TD/TL mode:
    ''' P300S AND IsLTMIMSpecOn() = ON and TD Mode = FALSE
    ''' </summary>
    ''' <returns>True if it is one of the conditions is met</returns>
    ''' <remarks>Sample codes only. It does not detect all specifications of each machine</remarks>
    Protected Function IsP300S_TL() As Boolean
        Dim objSpec As Okuma.CLDATAPI.DataAPI.CSpec = New Okuma.CLDATAPI.DataAPI.CSpec
        Dim blnValue As Boolean = False
        If GetControlType() = Okuma.CLDATAPI.Enumerations.ControlTypeEnum.P300SLP And objSpec.IsLTMIMSpecOn() = True And IsTDMode() = False Then blnValue = True
        Return blnValue
    End Function

    ''' <summary>
    ''' Detect if the control type used for functions designed to work for the following control types:
    ''' P300S and in TD or TL
    ''' </summary>
    ''' <returns>True if it is one of the conditions is met</returns>
    ''' <remarks>Sample codes only. It does not detect all specifications of each machine</remarks>
    Protected Function IsP300S() As Boolean
        Dim objSpec As Okuma.CLDATAPI.DataAPI.CSpec = New Okuma.CLDATAPI.DataAPI.CSpec
        Dim blnValue As Boolean = False
        If GetControlType() = Okuma.CLDATAPI.Enumerations.ControlTypeEnum.P300SLP And objSpec.IsLTMIMSpecOn() = True Then blnValue = True
        Return blnValue
    End Function

    ''' <summary>
    ''' Detect if the control type and its TD/TL mode can be used for functions designed to work for the following control types and TD/TL mode:
    ''' P300S AND IsLTMIMSpecOn() = ON
    ''' P300L AND IsLTMIMSpecOn() = ON 
    ''' </summary>
    ''' <returns>True if it is one of the conditions is met</returns>
    ''' <remarks>Sample codes only. It does not detect all specifications of each machine</remarks>
    Protected Function IsP300SP300L() As Boolean
        Return IsP300L() Or IsP300S()
    End Function

    ''' <summary>
    ''' Get the turret given sub system
    ''' </summary>
    ''' <param name="enSubSystem"></param>
    ''' <param name="blnDualSidesLathe"></param>
    ''' <returns>A TurretStationEnum value that represents that turret for the given sub system</returns>
    ''' <remarks>The availability of the turret will depend on the specification of each machine.</remarks>
    Private Function GetTurretBySubSystem(ByVal enSubSystem As Okuma.CLDATAPI.Enumerations.SubSystemEnum, Optional ByVal blnDualSidesLathe As Boolean = False) As Okuma.CLDATAPI.Enumerations.TurretEnum
        Dim enTurretStation As Okuma.CLDATAPI.Enumerations.TurretEnum

        If IsValidSubSystem(enSubSystem) = False Then
            Throw New ApplicationException(String.Format("Subsystem {0} cannot be by current machine specification " & enSubSystem.ToString))
        End If

        Select Case enSubSystem
            Case Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_AL, Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_AR, Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_PANEL_1, Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_RUN_1
                If blnDualSidesLathe = False Then enTurretStation = Okuma.CLDATAPI.Enumerations.TurretEnum.A_Turret
                If blnDualSidesLathe = True Then enTurretStation = Okuma.CLDATAPI.Enumerations.TurretEnum.R_Side_Turret
            Case Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_BL, Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_BR, Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_PANEL_2, Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_RUN_2
                If IsBTurretSpecCodeOn() = False Then Throw New ApplicationException("B turret cannot be supported by current machine specification")
                enTurretStation = Okuma.CLDATAPI.Enumerations.TurretEnum.B_Turret
            Case Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_CL, Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_CR, Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_PANEL_3, Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_RUN_3
                If IsCTurretSpecCodeOn() = False Then Throw New ApplicationException("C turret cannot be supported by current machine specification")
                enTurretStation = Okuma.CLDATAPI.Enumerations.TurretEnum.C_Turret
            Case Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_2AL
                enTurretStation = Okuma.CLDATAPI.Enumerations.TurretEnum.L_Side_Turret
            Case Else
                If IsATurretSeletected() Then
                    If blnDualSidesLathe = False Then enTurretStation = Okuma.CLDATAPI.Enumerations.TurretEnum.A_Turret
                    If blnDualSidesLathe = True Then enTurretStation = Okuma.CLDATAPI.Enumerations.TurretEnum.R_Side_Turret
                ElseIf IsBTurretSeletected() Then
                    enTurretStation = Okuma.CLDATAPI.Enumerations.TurretEnum.B_Turret
                ElseIf IsCTurretSeletected() Then
                    enTurretStation = Okuma.CLDATAPI.Enumerations.TurretEnum.C_Turret
                Else
                    If blnDualSidesLathe = False Then enTurretStation = Okuma.CLDATAPI.Enumerations.TurretEnum.A_Turret
                    If blnDualSidesLathe = True Then enTurretStation = Okuma.CLDATAPI.Enumerations.TurretEnum.R_Side_Turret
                End If

        End Select

        Return enTurretStation
    End Function

    ''' <summary>
    ''' Get tool location given sub system
    ''' </summary>
    ''' <param name="enSubSystem"></param>
    ''' <param name="blnDualSidesLathe"></param>
    ''' <returns>A ToolLocationEnum value that represents the turret for the given sub system</returns>
    ''' <remarks>The availability of the turret will depend on the specification of each machine.</remarks>
    Private Function GetToolLocationBySubSystem(ByVal enSubSystem As Okuma.CLDATAPI.Enumerations.SubSystemEnum, Optional ByVal blnDualSidesLathe As Boolean = False) As Okuma.CLCMDAPI.Enumerations.ToolLocationEnum
        Dim enToolLocation As Okuma.CLCMDAPI.Enumerations.ToolLocationEnum

        If IsValidSubSystem(enSubSystem) = False Then
            Throw New ApplicationException(String.Format("Subsystem {0} cannot be by current machine specification " & enSubSystem.ToString))
        End If

        Select Case enSubSystem
            Case Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_AL, Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_AR, Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_PANEL_1, Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_RUN_1
                If blnDualSidesLathe = False Then enToolLocation = Okuma.CLCMDAPI.Enumerations.ToolLocationEnum.A_Turret
                If blnDualSidesLathe = True Then enToolLocation = Okuma.CLCMDAPI.Enumerations.ToolLocationEnum.A2_Turret
            Case Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_BL, Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_BR, Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_PANEL_2, Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_RUN_2
                If IsBTurretSpecCodeOn() = False Then Throw New ApplicationException("B turret cannot be supported by current machine specification")
                enToolLocation = Okuma.CLCMDAPI.Enumerations.ToolLocationEnum.B_Turret
            Case Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_CL, Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_CR, Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_PANEL_3, Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_RUN_3
                If IsCTurretSpecCodeOn() = False Then Throw New ApplicationException("C turret cannot be supported by current machine specification")
                enToolLocation = Okuma.CLCMDAPI.Enumerations.ToolLocationEnum.C_Turret
            Case Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_2AL
                enToolLocation = Okuma.CLCMDAPI.Enumerations.ToolLocationEnum.A2_Turret
            Case Else
                If IsATurretSeletected() Then
                    If blnDualSidesLathe = False Then enToolLocation = Okuma.CLDATAPI.Enumerations.TurretEnum.A_Turret
                    If blnDualSidesLathe = True Then enToolLocation = Okuma.CLCMDAPI.Enumerations.ToolLocationEnum.A2_Turret
                ElseIf IsBTurretSeletected() Then
                    enToolLocation = Okuma.CLCMDAPI.Enumerations.ToolLocationEnum.B_Turret
                ElseIf IsCTurretSeletected() Then
                    enToolLocation = Okuma.CLCMDAPI.Enumerations.ToolLocationEnum.C_Turret
                Else
                    If blnDualSidesLathe = False Then enToolLocation = Okuma.CLCMDAPI.Enumerations.ToolLocationEnum.A_Turret
                    If blnDualSidesLathe = True Then enToolLocation = Okuma.CLCMDAPI.Enumerations.ToolLocationEnum.A2_Turret
                End If

        End Select

        Return enToolLocation
    End Function

    ''' <summary>
    ''' Get number of tool/pot available for current sub system
    ''' </summary>
    ''' <param name="enSubSystem"></param>
    ''' <returns>The number of tool/pot that are available give current sub system</returns>
    ''' <remarks>Sample codes only. It does not detect all specifications of each machine</remarks>
    Private Function GetToolNos(ByVal enSubSystem As Okuma.CLDATAPI.Enumerations.SubSystemEnum) As Integer
        Dim objTurret As New Okuma.CLDATAPI.DataAPI.CTurret
        Dim intToolNos As Integer
        Dim blnMultiToolSpec As Boolean

        blnMultiToolSpec = GetBSpecCode(24, 7)

        If enSubSystem = Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_RUN_1 Or enSubSystem = Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_PANEL_1 Or enSubSystem = Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_AL Or _
            enSubSystem = Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_AR Or enSubSystem = Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_2AL Then

            objTurret.SetSubSystem(enSubSystem)
            intToolNos = objTurret.GetMaxToolPots(Okuma.CLDATAPI.Enumerations.TurretEnum.A_Turret)

            If IsP300S_TD() Then intToolNos = 9999
            If IsP300L() And blnMultiToolSpec Then intToolNos = 9999

        ElseIf enSubSystem = Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_RUN_2 Or enSubSystem = Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_PANEL_2 Or enSubSystem = Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_BL Or _
                enSubSystem = Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_BR Then

            objTurret.SetSubSystem(enSubSystem)
            intToolNos = objTurret.GetMaxToolPots(Okuma.CLDATAPI.Enumerations.TurretEnum.B_Turret)

            If IsP300L() And blnMultiToolSpec Then intToolNos = 9999

        ElseIf enSubSystem = Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_RUN_3 Or enSubSystem = Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_PANEL_3 Or enSubSystem = Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_CL Or _
                enSubSystem = Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_CR Then

            objTurret.SetSubSystem(enSubSystem)
            intToolNos = objTurret.GetMaxToolPots(Okuma.CLDATAPI.Enumerations.TurretEnum.C_Turret)

            If IsP300L() And blnMultiToolSpec Then intToolNos = 9999

        ElseIf enSubSystem = Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_RUN Or enSubSystem = Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_PANEL Then

            If IsATurretSeletected() Then

                objTurret.SetSubSystem(Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_AL)
                intToolNos = objTurret.GetMaxToolPots(Okuma.CLDATAPI.Enumerations.TurretEnum.A_Turret)

                If IsP300S_TD() Then intToolNos = 9999
                If IsP300L() And blnMultiToolSpec Then intToolNos = 9999

            ElseIf IsBTurretSeletected() Then
                objTurret.SetSubSystem(Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_BL)
                intToolNos = objTurret.GetMaxToolPots(Okuma.CLDATAPI.Enumerations.TurretEnum.B_Turret)

                If IsP300L() And blnMultiToolSpec Then intToolNos = 9999

            ElseIf IsCTurretSeletected() Then
                objTurret.SetSubSystem(Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_CL)
                intToolNos = objTurret.GetMaxToolPots(Okuma.CLDATAPI.Enumerations.TurretEnum.C_Turret)

                If IsP300L() And blnMultiToolSpec Then intToolNos = 9999

            Else
                'otherwise, it is assuming that it is A turret
                objTurret.SetSubSystem(Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_AL)
                intToolNos = objTurret.GetMaxToolPots(Okuma.CLDATAPI.Enumerations.TurretEnum.A_Turret)

                If IsP300S_TD() Then intToolNos = 9999
                If IsP300L() And blnMultiToolSpec Then intToolNos = 9999

            End If
        End If

        Return intToolNos
    End Function
#End Region
#End Region

#Region "CTools.RegisterTools Example"
    ''' <summary>
    ''' Register tools for P300S only
    ''' </summary>
    ''' <param name="intToolNos"></param>
    ''' <remarks>Sample codes only. It does not detect all specifications of each machine</remarks>
    Public Sub RegisterTools_P300S(ByRef intToolNos() As Integer)
        Dim intToolNo As Integer
        Dim intTarget As Integer
        Dim intToolEdgeNo As Integer = 1
        Dim intPotNo As Integer = 1
        Dim blnMultiEdgeTool As Boolean
        Dim enBasicPositionSpindles As ArrayList
        Dim intBaseCuttingPosition() As Integer
        Dim enBasicPositionSpindle As Okuma.CLCMDAPI.Enumerations.BasicPositionSpindleEnum
        Dim objDATATC As New Okuma.CLDATAPI.DataAPI.CATC
        Dim objCmdATC As New Okuma.CLCMDAPI.CommandAPI.CATC
        Dim objTools As New Okuma.CLDATAPI.DataAPI.CTools
        Dim objTurret As New Okuma.CLDATAPI.DataAPI.CTurret

        blnMultiEdgeTool = GetSpecCode(5, 3)

        enBasicPositionSpindles = GetBaseSpindlePosition()
        intBaseCuttingPosition = GetBaseCuttingPositionNos()

        enBasicPositionSpindle = enBasicPositionSpindles.Item(0)

        For Each intToolNo In intToolNos
            intTarget = 0   ' register tool without assigning its location on magazine
            intToolEdgeNo = 0 ' register non-multi-edge tool 

            'assign at least 1 edge for multi-tool if needed
            If blnMultiEdgeTool = True Then intToolEdgeNo = 1

            objCmdATC.RegisterTool(intToolNo, intTarget, intToolEdgeNo, Okuma.CLCMDAPI.Enumerations.SettingToolKindEnum.L_Tool, Okuma.CLCMDAPI.Enumerations.SettingToolSizeEnum.Standard, enBasicPositionSpindle, intBaseCuttingPosition(0), 0, Okuma.CLCMDAPI.Enumerations.ToolLocationEnum.Magazine)

            'if machine can multi-edge tools then register edges to the tool
            If blnMultiEdgeTool = True Then
                RegisterEdgeNo(intToolNo)
            End If
        Next

        'attach all registered tools to magazine
        intPotNo = 1
        For Each intToolNo In intToolNos
            objCmdATC.AttachTool(intToolNo, intPotNo, Okuma.CLCMDAPI.Enumerations.ToolLocationEnum.Magazine)
            intPotNo = intPotNo + 1
        Next

    End Sub

    ''' <summary>
    ''' Register tool on P300L or newer control type
    ''' </summary>
    ''' <param name="intToolNos">List of integer contains to number to be registered with the system</param>
    ''' <remarks>Sample codes only. It does not detect all specifications of each machine</remarks>
    Private Sub RegisterTools_P300L(ByRef intToolNos() As Integer, ByVal enSubSystem As Okuma.CLDATAPI.Enumerations.SubSystemEnum)
        Dim intToolNo As Integer
        Dim intTarget As Integer
        Dim intToolEdgeNo As Integer = 1
        Dim intIndex As Integer
        Dim intPotNo As Integer = 1

        Dim blnMultiToolSpec As Boolean
        Dim blnSubSpindleSpec As Boolean
        Dim enSpindle As Okuma.CLCMDAPI.Enumerations.BasicPositionSpindleEnum
        Dim blnATurret As Boolean
        Dim blnBTurret As Boolean
        Dim blnCTurret As Boolean
        Dim enToolLocation As Okuma.CLCMDAPI.Enumerations.ToolLocationEnum
        Dim objCmdATC As New Okuma.CLCMDAPI.CommandAPI.CATC

        'default A turret
        blnATurret = True

        blnMultiToolSpec = GetBSpecCode(24, 7)

        If IsBTurretSpecCodeOn() Then
            blnBTurret = True
        End If

        If IsCTurretSpecCodeOn() Then
            blnCTurret = True
        End If

        'clear tools in Magazine, H1, B-Turret
        ClearTool()

        blnSubSpindleSpec = GetSpecCode(4, 1)

        If blnMultiToolSpec Then

            For Each intToolNo In intToolNos
                intToolEdgeNo = 0

                If blnSubSpindleSpec Then

                    'assigned different values
                    If enSpindle = Okuma.CLCMDAPI.Enumerations.BasicPositionSpindleEnum.Spindle_1 Then
                        enSpindle = Okuma.CLCMDAPI.Enumerations.BasicPositionSpindleEnum.Spindle_2
                    ElseIf enSpindle = Okuma.CLCMDAPI.Enumerations.BasicPositionSpindleEnum.Spindle_2 Then
                        enSpindle = Okuma.CLCMDAPI.Enumerations.BasicPositionSpindleEnum.Spindle_12
                    ElseIf enSpindle = Okuma.CLCMDAPI.Enumerations.BasicPositionSpindleEnum.Spindle_12 Then
                        enSpindle = Okuma.CLCMDAPI.Enumerations.BasicPositionSpindleEnum.Spindle_1
                    Else
                        enSpindle = Okuma.CLCMDAPI.Enumerations.BasicPositionSpindleEnum.Spindle_1
                    End If
                Else
                    enSpindle = Okuma.CLCMDAPI.Enumerations.BasicPositionSpindleEnum.None
                End If

                enToolLocation = GetToolLocationBySubSystem(enSubSystem)
                intIndex = intIndex + 1

                intTarget = intIndex
                objCmdATC.RegisterTool(intToolNo, intTarget, Okuma.CLCMDAPI.Enumerations.SettingToolKindEnum.DummyTool, enSpindle, enToolLocation)

            Next

        Else

            For Each intToolNo In intToolNos
                intToolEdgeNo = 0

                If blnSubSpindleSpec Then

                    'assigned different values
                    If enSpindle = Okuma.CLCMDAPI.Enumerations.BasicPositionSpindleEnum.Spindle_1 Then
                        enSpindle = Okuma.CLCMDAPI.Enumerations.BasicPositionSpindleEnum.Spindle_2
                    ElseIf enSpindle = Okuma.CLCMDAPI.Enumerations.BasicPositionSpindleEnum.Spindle_2 Then
                        enSpindle = Okuma.CLCMDAPI.Enumerations.BasicPositionSpindleEnum.Spindle_12
                    ElseIf enSpindle = Okuma.CLCMDAPI.Enumerations.BasicPositionSpindleEnum.Spindle_12 Then
                        enSpindle = Okuma.CLCMDAPI.Enumerations.BasicPositionSpindleEnum.Spindle_1
                    Else
                        enSpindle = Okuma.CLCMDAPI.Enumerations.BasicPositionSpindleEnum.Spindle_1
                    End If
                Else
                    enSpindle = Okuma.CLCMDAPI.Enumerations.BasicPositionSpindleEnum.None
                End If

                enToolLocation = GetToolLocationBySubSystem(enSubSystem)

                If blnMultiToolSpec Then
                    intTarget = intToolNo
                    objCmdATC.RegisterTool(intToolNo, intTarget, Okuma.CLCMDAPI.Enumerations.SettingToolKindEnum.DummyTool, enSpindle, enToolLocation)
                Else
                    intTarget = intToolNo
                    objCmdATC.RegisterTool(intToolNo, intTarget, Okuma.CLCMDAPI.Enumerations.SettingToolKindEnum.DummyTool, enSpindle, enToolLocation)
                End If

            Next
        End If


    End Sub

    ''' <summary>
    ''' Register edges to the  given tool number.
    ''' </summary>
    ''' <param name="intToolNo">A registered multi-edge tool number where tool edges will be registered with</param>
    ''' <remarks>Sample codes only. It does not detect all specifications of each machine</remarks>
    Public Sub RegisterEdgeNo(ByVal intToolNo As Integer)
        Dim intToolEdgeNos() As Integer
        Dim dblAngle As Double = 0
        Dim intToolCuttingPostionNos() As Integer
        Dim enBasicPositionSpindles As ArrayList
        Dim intBaseCuttingPosition() As Integer

        Dim objCmdATC As New Okuma.CLCMDAPI.CommandAPI.CATC

        enBasicPositionSpindles = GetBaseSpindlePosition()
        intBaseCuttingPosition = GetBaseCuttingPositionNos()

        intToolCuttingPostionNos = GetToolCuttingPositionNos()

        intToolEdgeNos = GetCurrentToolEdgeNos()

        For Each enToolEdge As Okuma.CLCMDAPI.Enumerations.ToolEdgeEnum In intToolEdgeNos
            If enToolEdge <> Okuma.CLCMDAPI.Enumerations.ToolEdgeEnum.ToolEdge_01 Then
                objCmdATC.RegisterToolEdge(intToolNo, enToolEdge, enBasicPositionSpindles(0), intBaseCuttingPosition(0), dblAngle)
            End If
        Next
    End Sub

    ''' <summary>
    ''' For P300S/P300L or newer controls:
    ''' Clear all tool currently attached and registered in the system
    ''' </summary>
    ''' <remarks>Sample codes only. It does not detect all specifications of each machine</remarks>
    Private Sub ClearTool()
        Dim inStationNo As Integer
        Dim intToolNo As Integer
        Dim intPotNo As Integer
        Dim intCount As Integer
        Dim objDATATC As New Okuma.CLDATAPI.DataAPI.CATC
        Dim objCmdATC As New Okuma.CLCMDAPI.CommandAPI.CATC
        Dim objCTools As New Okuma.CLDATAPI.DataAPI.CTools
        Dim objCTurret As New Okuma.CLDATAPI.DataAPI.CTurret
        Dim intTools() As Integer

        If IsP300S_TD() Then

            'clear magazine by checking for any tool mounted in a pot
            intCount = objDATATC.GetMaxPots(Okuma.CLDATAPI.Enumerations.MagazineTypeEnum.MainMagazine)

            For intPotNo = 1 To intCount
                intToolNo = objDATATC.GetToolNo(intPotNo)
                If intToolNo > 0 Then
                    'detatching a tool currently mounted in this pot number on ATC magazine
                    objCmdATC.DetachTool(intPotNo, Okuma.CLCMDAPI.Enumerations.ToolLocationEnum.Magazine)
                End If
            Next

            'clear H1 Turret
            intToolNo = objCTools.GetCurrentToolNumber
            If intToolNo > 0 Then
                'detatching a tool currently mounted in spindle or H1 turret
                objCmdATC.DetachTool(1, Okuma.CLCMDAPI.Enumerations.ToolLocationEnum.H1_Turret)
            End If

            'clear B turret
            If IsValidSubSystem(Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_BL) Then
                intCount = objCTurret.GetMaxToolPots(Okuma.CLDATAPI.Enumerations.TurretEnum.B_Turret)
                objCTurret.SetSubSystem(Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_BL)

                For inStationNo = 1 To intCount
                    intToolNo = objCTurret.GetToolNo(inStationNo)
                    If intToolNo > 0 Then
                        objCmdATC.DetachTool(inStationNo, Okuma.CLCMDAPI.Enumerations.ToolLocationEnum.B_Turret)
                    End If
                Next
            End If

            'remove all registered tools after detaching the tools from magazine pots or turret stations
            intTools = objCTools.GetToolList(Okuma.CLDATAPI.Enumerations.ToolListTypeEnum.AllTools)
            For Each intToolNo In intTools
                objCmdATC.DeleteTool(intToolNo)
            Next

        ElseIf IsP300L() Then
            ClearP300LToolTable()
        End If

    End Sub

    ''' <summary>
    ''' For P300L or newer controls:
    ''' Clear all tool currently attached and registered in the system
    ''' </summary>
    ''' <remarks>Sample codes only. It does not detect all specifications of each machine</remarks>
    Private Sub ClearP300LToolTable()
        Dim inStationNo As Integer
        Dim intToolNo As Integer
        Dim intCount As Integer
        Dim intToolList() As Integer
        Dim objDATATC As New Okuma.CLDATAPI.DataAPI.CATC
        Dim objCmdATC As New Okuma.CLCMDAPI.CommandAPI.CATC
        Dim objTools As New Okuma.CLDATAPI.DataAPI.CTools
        Dim objTurret As New Okuma.CLDATAPI.DataAPI.CTurret

        If IsValidSubSystem(Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_AL) Then
            'clear A Turret
            'set sub system to work with tool data related to A turret
            objTurret.SetSubSystem(Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_AL)
            intCount = objTurret.GetMaxToolPots(Okuma.CLDATAPI.Enumerations.TurretEnum.A_Turret)

            For inStationNo = 1 To intCount
                intToolNo = objTurret.GetToolNo(inStationNo)
                If intToolNo > 0 Then
                    'detach tool by location of tool on turret
                    objCmdATC.DetachTool(inStationNo, Okuma.CLCMDAPI.Enumerations.ToolLocationEnum.A_Turret)
                    'un-register the tool after detatching
                    objCmdATC.DeleteTool(intToolNo)
                End If
            Next

        End If


        If IsValidSubSystem(Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_BL) Then
            'clear B turret
            If IsBTurretSpecCodeOn() Then
                'set sub system to work with tool data related to B turret
                objTurret.SetSubSystem(Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_BL)
                intCount = objTurret.GetMaxToolPots(Okuma.CLDATAPI.Enumerations.TurretEnum.B_Turret)

                For inStationNo = 1 To intCount
                    intToolNo = objTurret.GetToolNo(inStationNo)
                    If intToolNo > 0 Then
                        'detach tool by location of tool on turret
                        objCmdATC.DetachTool(inStationNo, Okuma.CLCMDAPI.Enumerations.ToolLocationEnum.B_Turret)
                        'un-register the tool after detatching
                        objCmdATC.DeleteTool(intToolNo)
                    End If
                Next

            End If
        End If


        If IsValidSubSystem(Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_CL) Then
            'clear C turret
            If IsCTurretSpecCodeOn() Then
                'set sub system to work with tool data related to C turret
                objTurret.SetSubSystem(Okuma.CLDATAPI.Enumerations.SubSystemEnum.NC_CL)
                intCount = objTurret.GetMaxToolPots(Okuma.CLDATAPI.Enumerations.TurretEnum.C_Turret)

                For inStationNo = 1 To intCount
                    intToolNo = objTurret.GetToolNo(inStationNo)
                    If intToolNo > 0 Then
                        'detach tool by location of tool on turret
                        objCmdATC.DetachTool(inStationNo, Okuma.CLCMDAPI.Enumerations.ToolLocationEnum.C_Turret)
                        'un-register the tool after detatching
                        objCmdATC.DeleteTool(intToolNo)
                    End If
                Next

            End If
        End If

        'un-register the rest of  all registered tools in the system
        intToolList = objTools.GetToolList(Okuma.CLDATAPI.Enumerations.ToolListTypeEnum.RegisteredTool)

        For Each intToolNo In intToolList
            If intToolNo > 0 Then
                objCmdATC.DeleteTool(intToolNo)
            End If
        Next

    End Sub

    ''' <summary>
    ''' Get list of available tool kind given tool location
    ''' </summary>
    ''' <param name="enLocation"></param>
    ''' <returns></returns>
    ''' <remarks>
    ''' Mill Tool
    ''' <para>Valid for tool assign to A Turret when CCM(NC1 No.3 bit0)=ON and MWOC(NC1 No.3 bit2)=OFF</para>
    ''' <para>Valid for tool assign to B Turret when BRTL(NC1 No.3 bit1)=ON and BCWOM(NC2 No.26 bit2)=OFF </para>
    ''' <para>Valid for tool assign to C Turret when CTSP(NC2 No.21 bit5)=ON </para>
    ''' </remarks>
    Public Function GetSettingToolKindList(ByVal enLocation As Okuma.CLCMDAPI.Enumerations.ToolLocationEnum) As ArrayList
        Dim arSettingToolKind As New ArrayList

        'detect Multi-Edge Tool spec
        If GetSpecCode(5, 3) = False Then
            arSettingToolKind.Add(Okuma.CLCMDAPI.Enumerations.SettingToolKindEnum.DummyTool)
        End If

        If GetSpecCode(3, 0) Then
            arSettingToolKind.Add(Okuma.CLCMDAPI.Enumerations.SettingToolKindEnum.L_Tool)
        End If

        If enLocation = Okuma.CLCMDAPI.Enumerations.ToolLocationEnum.A_Turret _
            Or enLocation = Okuma.CLCMDAPI.Enumerations.ToolLocationEnum.A2_Turret _
            Or enLocation = Okuma.CLCMDAPI.Enumerations.ToolLocationEnum.H1_Turret _
            Or enLocation = Okuma.CLCMDAPI.Enumerations.ToolLocationEnum.Magazine Then

            If GetSpecCode(3, 0) And GetSpecCode(3, 2) = False Then
                arSettingToolKind.Add(Okuma.CLCMDAPI.Enumerations.SettingToolKindEnum.M_Tool)
            End If

            arSettingToolKind.Add(Okuma.CLCMDAPI.Enumerations.SettingToolKindEnum.SensorTool)

        End If

        If enLocation = Okuma.CLCMDAPI.Enumerations.ToolLocationEnum.B_Turret Then
            If GetBSpecCode(21, 5) = False Then
                arSettingToolKind.Add(Okuma.CLCMDAPI.Enumerations.SettingToolKindEnum.M_Tool)
            End If
        End If

        If enLocation = Okuma.CLCMDAPI.Enumerations.ToolLocationEnum.C_Turret Then
            If GetSpecCode(3, 1) And GetBSpecCode(26, 2) = False Then
                arSettingToolKind.Add(Okuma.CLCMDAPI.Enumerations.SettingToolKindEnum.M_Tool)
            End If
        End If

        Return arSettingToolKind

    End Function


    ''' <summary>
    ''' Get basic position of spindle that are available in the system
    ''' </summary>
    ''' <returns>An arraylist of BasicPositionSpindleEnum value</returns>
    ''' <remarks>Sample codes only. It does not detect all specifications of each machine</remarks>
    Public Function GetBaseSpindlePosition() As ArrayList
        Dim enValues As ArrayList = New ArrayList()

        Dim enBasicPositionSpindles() As Okuma.CLCMDAPI.Enumerations.BasicPositionSpindleEnum = System.Enum.GetValues(GetType(Okuma.CLCMDAPI.Enumerations.BasicPositionSpindleEnum))

        For Each enBasicPositionSpindle As Okuma.CLCMDAPI.Enumerations.BasicPositionSpindleEnum In enBasicPositionSpindles
            Select Case enBasicPositionSpindle
                Case Okuma.CLCMDAPI.Enumerations.BasicPositionSpindleEnum.None
                    If GetSpecCode(4, 1) = False Then
                        enValues.Add(Okuma.CLCMDAPI.Enumerations.BasicPositionSpindleEnum.None)
                    End If

                Case Okuma.CLCMDAPI.Enumerations.BasicPositionSpindleEnum.Spindle_1
                    If GetSpecCode(4, 1) = True Then
                        enValues.Add(Okuma.CLCMDAPI.Enumerations.BasicPositionSpindleEnum.Spindle_1)
                    End If

                Case Okuma.CLCMDAPI.Enumerations.BasicPositionSpindleEnum.Spindle_2
                    If GetSpecCode(4, 1) = True Then
                        enValues.Add(Okuma.CLCMDAPI.Enumerations.BasicPositionSpindleEnum.Spindle_2)
                    End If

                Case Okuma.CLCMDAPI.Enumerations.BasicPositionSpindleEnum.Spindle_12
                    If GetSpecCode(4, 1) = True Then
                        enValues.Add(Okuma.CLCMDAPI.Enumerations.BasicPositionSpindleEnum.Spindle_12)
                    End If
            End Select
        Next

        Return enValues

    End Function

    ''' <summary>
    ''' Get base cutting position for upper turret or H1 turret  only
    ''' BaseCuttingPositionSettingEnum 
    ''' B-axis control spec = NC Standard No.8 bit7
    ''' L Tool Index spec = NC Standard No.3 bit4
    ''' None -       B-axis control spec and L Tool Index spec are OFF.  
    ''' Base -       B-axis control spec is ON and L Tool Index spec is OFF.  
    ''' Vertical -   B-axis control spec is ON and L Tool Index spec is OFF.  
    ''' Base_A -     B-axis control spec is ON and L Tool Index spec is ON.  
    ''' Base_B -     B-axis control spec is ON and L Tool Index spec is ON.  
    ''' Vertical_A - B-axis control spec and L Tool Index are ON.  
    ''' Vertical_B - B-axis control spec and L Tool Index are ON.  
    ''' </summary>
    ''' <returns>An array of integer that represent different values of base cutting position</returns>
    ''' <remarks>Sample codes only. It does not detect all specifications of each machine</remarks>
    Public Function GetBaseCuttingPositionNos() As Integer()
        Dim blnBAxisCtrlSpec As Boolean
        Dim blnLToolIndexSpec As Boolean
        Dim intToolCuttingPostionNos() As Integer
        Dim ar As New ArrayList

        blnBAxisCtrlSpec = GetSpecCode(8, 7)
        blnLToolIndexSpec = GetSpecCode(3, 4)

        intToolCuttingPostionNos = Array.CreateInstance(GetType(Integer), 6)

        If blnBAxisCtrlSpec = False And blnLToolIndexSpec = False Then
            ar.Add(0) 'None
        ElseIf blnBAxisCtrlSpec = True And blnLToolIndexSpec = False Then
            ar.Add(1) 'Base
            ar.Add(2) 'Vertical
        ElseIf blnBAxisCtrlSpec = True And blnLToolIndexSpec = True Then
            ar.Add(3) 'Base_A
            ar.Add(4) 'Base_B
            ar.Add(5) 'Vertical_A
            ar.Add(6) 'Vertical_B
        End If

        intToolCuttingPostionNos = ar.ToArray(GetType(Integer))

        Return intToolCuttingPostionNos
    End Function

    ''' <summary>
    ''' Get list of all Tool Cutting positions
    ''' </summary>
    ''' <returns>An array of integer that represents different values of tool cutting position</returns>
    ''' <remarks>Sample codes only. It does not detect all specifications of each machine</remarks>
    Public Function GetToolCuttingPositionNos() As Integer()
        Dim intToolCuttingPositionNos() As Integer
        Dim ar As New ArrayList
        Dim blnBAxisCtrlSpec As Boolean
        Dim blnLToolIndexSpec As Boolean
        Dim blnSubSpindle As Boolean
        Dim intCuttingPositions As Integer

        'detect base cutting position settting
        blnBAxisCtrlSpec = GetSpecCode(8, 7)
        blnLToolIndexSpec = GetSpecCode(3, 4)
        blnSubSpindle = GetSpecCode(4, 1)

        If blnBAxisCtrlSpec = True And blnLToolIndexSpec = False And blnSubSpindle = False Then
            intCuttingPositions = 11
        ElseIf blnBAxisCtrlSpec = True And blnLToolIndexSpec = True And blnSubSpindle = False Then
            intCuttingPositions = 14
        ElseIf blnBAxisCtrlSpec = True And blnLToolIndexSpec = False And blnSubSpindle = True Then
            intCuttingPositions = 14
        Else
            intCuttingPositions = 20
        End If

        intToolCuttingPositionNos = Array.CreateInstance(GetType(Integer), intCuttingPositions)

        ar.Add(1)
        If blnBAxisCtrlSpec = True And blnLToolIndexSpec = True Then ar.Add(2)
        ar.Add(3)
        If blnBAxisCtrlSpec = True And blnLToolIndexSpec = True Then ar.Add(4)
        ar.Add(5)
        If blnBAxisCtrlSpec = True And blnLToolIndexSpec = True Then ar.Add(6)
        If blnSubSpindle Then ar.Add(7)
        If blnSubSpindle And blnBAxisCtrlSpec = True And blnLToolIndexSpec = True Then ar.Add(8)
        If blnSubSpindle Then ar.Add(9)
        If blnSubSpindle And blnBAxisCtrlSpec = True And blnLToolIndexSpec = True Then ar.Add(10)
        If blnSubSpindle Then ar.Add(11)
        If blnSubSpindle And blnBAxisCtrlSpec = True And blnLToolIndexSpec = True Then ar.Add(12)
        ar.Add(13)
        ar.Add(14)
        ar.Add(15)
        ar.Add(16)
        ar.Add(17)
        ar.Add(18)
        ar.Add(19)
        ar.Add(20)


        intToolCuttingPositionNos = ar.ToArray(GetType(Integer))

        Return intToolCuttingPositionNos
    End Function

    ''' <summary>
    ''' Get list of all Tool Cutting positions for B Turret
    ''' </summary>
    ''' <returns>An array of integer that represents different values of tool cutting position</returns>
    ''' <remarks>Sample codes only. It does not detect all specifications of each machine</remarks>
    Public Function GetToolCuttingPositionNosBTurret() As Integer()
        Dim intToolCuttingPositionNos() As Integer
        Dim ar As New ArrayList

        intToolCuttingPositionNos = Array.CreateInstance(GetType(Integer), 10)

        ar.Add(1)
        ar.Add(7)
        ar.Add(13)
        ar.Add(14)
        ar.Add(15)
        ar.Add(16)
        ar.Add(17)
        ar.Add(18)
        ar.Add(19)
        ar.Add(20)

        intToolCuttingPositionNos = ar.ToArray(GetType(Integer))

        Return intToolCuttingPositionNos
    End Function

    ''' <summary>
    ''' Get available tool edges
    ''' </summary>
    ''' <param name="blnTurret">for B turret</param>
    ''' <returns>An array of integer that represents that tool edge numbers</returns>
    ''' <remarks>Sample codes only. It does not detect all specifications of each machine</remarks>
    Public Function GetCurrentToolEdgeNos(Optional ByVal blnTurret As Boolean = False) As Integer()
        Dim blnToolEdge12Spec As Boolean
        Dim blnToolEdge8Spec As Boolean
        Dim blnToolEdge4Spec As Boolean
        Dim enToolEdgeNos() As Okuma.CLDATAPI.Enumerations.ToolEdgeEnum = System.Enum.GetValues(GetType(Okuma.CLDATAPI.Enumerations.ToolEdgeEnum))
        Dim intToolEdgeNos() As Integer
        Dim ar As New ArrayList
        Dim blnMultiEdgesToolSpec As Boolean
        Dim blnMultiToolSpec As Boolean

        'detect Multi-Edge Tool spec
        blnMultiEdgesToolSpec = GetSpecCode(5, 3)
        'detect Multi-Tool spec
        blnMultiToolSpec = GetBSpecCode(24, 7)

        'detect number of edges available when Multi-Edge Tool spec is ON
        blnToolEdge12Spec = IsPLC2SpecCodeTurnOn(34, 0)
        blnToolEdge8Spec = IsPLC2SpecCodeTurnOn(34, 1)
        blnToolEdge4Spec = IsPLC2SpecCodeTurnOn(34, 4)

        intToolEdgeNos = Array.CreateInstance(GetType(Integer), 13)

        If blnMultiToolSpec Then
            ar.Add(1)
            ar.Add(2)
            ar.Add(3)
            ar.Add(4)
            ar.Add(5)
            ar.Add(6)
            ar.Add(7)
            ar.Add(8)
        Else
            If blnTurret = False Then

                If blnToolEdge12Spec = True Then
                    ar.Add(1)
                    ar.Add(2)
                    ar.Add(3)
                    ar.Add(4)
                    ar.Add(5)
                    ar.Add(6)
                    ar.Add(7)
                    ar.Add(8)
                    ar.Add(9)
                    ar.Add(10)
                    ar.Add(11)
                    ar.Add(12)
                ElseIf blnToolEdge4Spec = True Then
                    ar.Add(1)
                    ar.Add(2)
                    ar.Add(3)
                    ar.Add(4)
                ElseIf blnToolEdge8Spec = True Then
                    ar.Add(1)
                    ar.Add(2)
                    ar.Add(3)
                    ar.Add(4)
                    ar.Add(5)
                    ar.Add(6)
                    ar.Add(7)
                    ar.Add(8)
                End If

            Else

                If blnToolEdge12Spec = True Then
                    ar.Add(1)
                    ar.Add(2)
                    ar.Add(3)
                    ar.Add(4)
                    ar.Add(5)
                    ar.Add(6)
                    ar.Add(7)
                    ar.Add(8)
                ElseIf blnToolEdge4Spec = True Then
                    ar.Add(1)
                    ar.Add(2)
                    ar.Add(3)
                    ar.Add(4)
                ElseIf blnToolEdge8Spec = True Then
                    ar.Add(1)
                    ar.Add(2)
                    ar.Add(3)
                    ar.Add(4)
                    ar.Add(5)
                    ar.Add(6)
                    ar.Add(7)
                    ar.Add(8)
                End If

            End If
        End If
        intToolEdgeNos = ar.ToArray(GetType(Integer))
        Return intToolEdgeNos
    End Function

    ''' -----------------------------------------------------------------------------
    ''' <summary>
    ''' generate integer values based on given the input values of  low and high 
    ''' </summary>
    ''' <param name="intLow"></param>
    ''' <param name="intHigh"></param>
    ''' <returns>An array of integer values</returns>
    ''' <remarks>
    ''' </remarks>
    ''' -----------------------------------------------------------------------------
    Public Function GeneratedTestValues(ByVal intLow As Integer, ByVal intHigh As Integer, _
                Optional ByVal intLength As Integer = 5) As Integer()
        Dim intReturnedValues() As Integer
        Dim ar As ArrayList = New ArrayList
        Dim intInterval As Integer

        If m_blnTestFullRange = True Then
            intLength = intHigh
        End If

        intInterval = (intHigh - intLow) / (intLength - 1)

        If intHigh < intLow Then
            'Note: in case of no B turret therefore no tool in B turret
            ' but we need to make code still work so we assign tool 0
            'instead of returning nothing as an object
            ar.Add(0)
        ElseIf intHigh = intLow Then
            ar.Add(intLow)
        Else
            For intIndex As Integer = 1 To intLength - 1
                ar.Add(intLow + (intIndex - 1) * intInterval)
            Next
            ar.Add(intHigh)
        End If
        intReturnedValues = ar.ToArray(GetType(Integer))
        Return intReturnedValues
    End Function

#End Region

End Class

